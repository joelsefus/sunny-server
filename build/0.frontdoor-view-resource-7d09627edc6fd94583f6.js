webpackJsonp([0],{138:function(t,e,n){var i,o,r,a,s,l,u,c,d,h,f,p,g,m,v,_,b,y=function(t,e){function n(){this.constructor=t}for(var i in e)C.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},C={}.hasOwnProperty;h=n(9),i=n(3),r=n(253),_=n(37),p=_.capitalize,v=_.navigate_to_url,m=_.make_field_input_ui,b=n(15),g=n(254).form_group_input_div,l=i.Radio.channel("global"),u=i.Radio.channel("messages"),d=i.Radio.channel("sunny"),f=b.renderable(function(t){var e,n,i,o;for(console.log("_edit_form",t),o=["name","fullname"],n=0,i=o.length;n<i;n++)e=o[n],g({input_id:"input_"+e,label:p(e),input_attributes:{name:e,placeholder:e,value:t[e]},value:t.title});return b.div(".form-group",function(){return b.label(".control-label",{"for":"input_description"},"Description"),b.textarea("#input_description.form-control",{name:"description",placeholder:"description"},t.description)})}),a=b.renderable(function(t){return f(t),b.input(".btn.btn-default",{type:"submit",value:"Submit"}),b.div(".spinner.fa.fa-spinner.fa-spin")}),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.fieldList=["name","fullname"],e.prototype.ui=function(){var t;return t=m(this.fieldList),h.extend(t,{description:'textarea[name="description"]'}),t},e.prototype.updateModel=function(){var t,e,n,i,o;for(i=this.fieldList.concat(["description"]),o=[],e=0,n=i.length;e<n;e++)t=i[e],console.log("field",t,this.ui[t].val()),o.push(this.model.set(t,this.ui[t].val()));return o},e.prototype.onSuccess=function(t){var e;return e=this.model.get("name"),u.request("display-message",e+" saved successfully.","success")},e}(r),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.template=a,e.prototype.createModel=function(){return d.request("new-client")},e.prototype.saveModel=function(){var t,n;return t={success:function(t){return function(){return t.trigger("save:form:success",t.model)}}(this),error:function(t){return function(){return t.trigger("save:form:failure",t.model)}}(this)},n=d.request("client-collection"),n.add(this.model),e.__super__.saveModel.apply(this,arguments)},e}(o),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.template=a,e.prototype.createModel=function(){return this.model},e}(o),t.exports={NewClientView:c,EditClientView:s}},248:function(t,e,n){var i,o,r,a,s,l,u,c,d,h,f,p=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},g={}.hasOwnProperty;o=n(3),u=n(8),i=n(252),n(287),n(271),n(284),n(283),n(282),n(273),n(274),n(278),n(279),n(280),n(281),n(277),n(275),n(276),n(272),d=n(285),r=n(253),h=n(37),f=h.remove_trailing_slashes,c=h.make_json_post,l=o.Radio.channel("global"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.saveModel=function(){var t;return t={success:function(t){return function(){return t.trigger("save:form:success",t.model)}}(this),error:function(t){return function(){return t.trigger("save:form:failure",t.model)}}(this),patch:!0},this.model.save(this.model.attributes,t)},e}(r),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.template=i.EditNodeForm,e.prototype.ui={body:"#document-body",title:'input[name="title"]',description:'input[name="description"]'},e.prototype.createModel=function(){return console.log("Model url",this.model.url()),this.model},e.prototype.onDomRefresh=function(){return this.ui.body.hallo({enable:!0,plugins:{halloformat:{},hallojustify:{},hallolists:{},halloreundo:{},halloimage:{},hallolink:{},halloblacklist:{},halloheadings:{},halloblock:{}}})},e.prototype.updateModel=function(){var t,e,n,i,o,r;for(console.log("Model",this.model),n=this.model.get("data"),e=n.attributes,r=["title","description"],i=0,o=r.length;i<o;i++)t=r[i],e[t]=this.ui[t].val();return e.body=this.ui.body.hallo("getContents"),e.tags=[],this.model.set("data",n),console.log("model updated",this.model,this.model.url())},e}(s),t.exports=a},249:function(t,e,n){var i,o,r,a,s,l,u,c,d,h,f,p=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},g={}.hasOwnProperty;o=n(3),s=n(8),i=n(252),h=n(37).navigate_to_url,f=n(72).show_modal,a=o.Radio.channel("global"),l=o.Radio.channel("messages"),d=o.Radio.channel("resources"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.template=i.ConfirmPageDeleteModal,e.prototype.ui={confirm_delete:"#confirm-delete-button",cancel_button:"#cancel-delete-button"},e.prototype.events=function(){return{"click @ui.confirm_delete":"confirm_delete"}},e.prototype.confirm_delete=function(){var t,e;return t=this.model.get("name"),e=this.model.destroy(),e.done(function(e){return function(){return l.request("display-message",t+" deleted.","success")}}(this)),e.fail(function(e){return function(){return l.request("display-message",t+" NOT deleted.","danger")}}(this))},e}(o.Marionette.ItemView),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.template=i.PageItem,e.prototype.ui={edit_page:".edit-page",delete_page:".delete-page",page_item:".page-item"},e.prototype.events=function(){return{"click @ui.edit_page":"edit_page","click @ui.delete_page":"delete_page"}},e.prototype.edit_page=function(){var t;return t=this.model.get("name"),h("#dbdocs/edit/"+t)},e.prototype.delete_page=function(){var t;return console.log("delete_page",this.model),t=new r({model:this.model}),f(t,!0)},e}(o.Marionette.ItemView),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.childView=u,e.prototype.template=i.PageList,e.prototype.childViewContainer="#pagecontainer",e.prototype.ui={make_new_page:"#makenewpage",new_page_name:"#newpagename"},e.prototype.events=function(){return{"click @ui.make_new_page":"make_new_page"}},e.prototype._show_modal=function(t,e){var n;return null==e&&(e=!1),n=a.request("main:app:get-region","modal"),n.backdrop=e,n.show(t)},e.prototype.make_new_page=function(){var t;return t=this.ui.new_page_name.val(),h("#dbdocs/newpage")},e}(o.Marionette.CompositeView),t.exports=c},250:function(t,e,n){var i,o,r,a,s,l,u,c,d=function(t,e){function n(){this.constructor=t}for(var i in e)h.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty;i=n(3),s=n(8),o=n(269),u=n(37),c=u.remove_trailing_slashes,l=u.make_json_post,a=i.Radio.channel("global"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.template=o.DefaultStaticDocumentTemplate,e}(i.Marionette.ItemView),t.exports={FrontDoorMainView:r}},251:function(t,e,n){var i,o,r,a,s,l,u,c,d,h,f,p,g,m,v=function(t,e){function n(){this.constructor=t}for(var i in e)_.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},_={}.hasOwnProperty;i=n(3),d=n(8),m=n(15),p=n(37).navigate_to_url,g=n(72).show_modal,f=n(71).modal_close_button,c=i.Radio.channel("global"),h=i.Radio.channel("messages"),u=m.renderable(function(t){return m.div(".modal-dialog",function(){return m.div(".modal-content",function(){return m.h3("Do you really want to delete "+t.name+"?"),m.div(".modal-body",function(){return m.div("#selected-children")}),m.div(".modal-footer",function(){return m.ul(".list-inline",function(){var t;return t="btn.btn-default.btn-sm",m.li("#confirm-delete-button",function(){return f("OK","check")}),m.li("#cancel-delete-button",function(){return f("Cancel")})})})})})}),o=m.renderable(function(t){var e;return e=".btn.btn-default.btn-xs",m.li(".list-group-item.client-item",function(){return m.span(function(){return m.a({href:"#client/view/"+t.name},t.name),m.div(".btn-group.pull-right",function(){return m.button(".edit-client."+e+".btn-info.fa.fa-edit","edit"),m.button(".delete-client."+e+".btn-danger.fa.fa-close","delete")})})})}),a=m.renderable(function(){return m.button("#new-client.btn.btn-default",function(){return"Add New Client"}),m.hr(),m.ul("#client-container.list-group")}),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.template=u,e.prototype.ui={confirm_delete:"#confirm-delete-button",cancel_button:"#cancel-delete-button"},e.prototype.events=function(){return{"click @ui.confirm_delete":"confirm_delete"}},e.prototype.confirm_delete=function(){var t,e;return t=this.model.get("name"),e=this.model.destroy(),e.done(function(e){return function(){return h.request("success",t+" deleted.")}}(this)),e.fail(function(e){return function(){return h.request("danger",t+" NOT deleted.")}}(this))},e}(i.Marionette.ItemView),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.template=o,e.prototype.ui={edit_client:".edit-client",delete_client:".delete-client",client_item:".client-item"},e.prototype.events=function(){return{"click @ui.edit_client":"edit_client","click @ui.delete_client":"delete_client"}},e.prototype.edit_client=function(){return p("#sunny/clients/edit/"+this.model.id)},e.prototype.delete_client=function(){var t;return console.log("delete_client",this.model),t=new l({model:this.model}),console.log("modal view",t),g(t,!0)},e}(i.Marionette.ItemView),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.childView=r,e.prototype.template=a,e.prototype.childViewContainer="#client-container",e.prototype.ui={make_new_client:"#new-client"},e.prototype.events=function(){return{"click @ui.make_new_client":"make_new_client"}},e.prototype._show_modal=function(t,e){var n;return null==e&&(e=!1),n=c.request("main:app:get-region","modal"),n.backdrop=e,n.show(t)},e.prototype.make_new_client=function(){return p("#sunny/clients/new")},e}(i.Marionette.CompositeView),t.exports=s},252:function(t,e,n){var i,o,r,a,s,l,u,c,d,h,f,p,g,m,v,_,b,y,C;y=n(15),g=n(136),_=n(71),v=_.navbar_collapse_button,d=_.dropdown_toggle,m=_.modal_close_button,f=n(254).form_group_input_div,b=n(134),p=b.frontdoor_url,h=b.editor_url,C=n(135).workflow_dropdown,c=n(37).capitalize,u=y.renderable(function(t){var e,n,i,o;for(o=["name","title","description"],n=0,i=o.length;n<i;n++)e=o[n],f({input_id:"input_"+e,label:c(e),input_attributes:{name:e,placeholder:e,value:t[e]},value:t.title});return y.div(".form-group",function(){return y.label(".control-label",{"for":"select_doctype"},"Doc Type"),y.select(".form-control",{name:"select_doctype"},function(){var e,n,i,o,r;for(o=["html","markdown"],r=[],e=0,n=o.length;e<n;e++)i=o[e],t.doctype===i?r.push(y.option({selected:null,value:i},i)):r.push(y.option({value:i},i));return r})})}),r=y.renderable(function(t){return u(t),y.div("#document-body",function(){return y.raw(t.data.attributes.body)}),y.input(".btn.btn-default",{type:"submit",value:"Update "+t.data.type})}),i=y.renderable(function(t){return u(t),y.div("#ace-editor",{style:"position:relative;width:100%;height:40em;"}),y.input(".btn.btn-default",{type:"submit",value:"Update "+t.data.type})}),s=y.renderable(function(t){var e;return e=".btn.btn-default.btn-xs",y.li(".page-item.list-group-item.row",function(){return y.div(".col-md-3.pull-left",function(){return y.a({href:"#dbdocs/view/"+t.name},t.name)}),y.div(".col-md-1.pull-right.button-group",function(){return y.button(".edit-page."+e+".btn-primary.fa.fa-edit"),y.button(".delete-page."+e+".btn-danger.fa.fa-close")})})}),l=y.renderable(function(){return y.button("#makenewpage.btn.btn-default",function(){return"new page"}),y.hr(),y.ul("#pagecontainer.list-group")}),o=y.renderable(function(t){return y.div(".modal-dialog",function(){return y.div(".modal-content",function(){return y.h3("Do you really want to delete "+t.name+"?"),y.div(".modal-body",function(){return y.div("#selected-children")}),y.div(".modal-footer",function(){return y.ul(".list-inline",function(){var t;return t="btn.btn-default.btn-sm",y.li("#confirm-delete-button",function(){return m("OK","check")}),y.li("#cancel-delete-button",function(){return m("Cancel")})})})})})}),a=y.renderable(function(t){return u(t),y.div("#ace-editor",{style:"position:relative;width:100%;height:40em;"}),y.input(".btn.btn-default",{type:"submit",value:"Add "+t.doctype}),y.div(".spinner.fa.fa-spinner.fa-spin")}),t.exports={AceEditNodeForm:i,PageItem:s,PageList:l,ConfirmPageDeleteModal:o,NewPageForm:a}},253:function(t,e,n){var i,o,r=function(t,e){return function(){return t.apply(e,arguments)}},a=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;o=n(257),i=function(t){function e(){return this.invalid=r(this.invalid,this),this.valid=r(this.valid,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.valid=function(t,e,n){return this.$("[data-validation="+e+"]").parent().removeClass("has-error").addClass("has-success")},e.prototype.invalid=function(t,e,n,i){return this.failure(this.model),this.$("[data-validation="+e+"]").parent().removeClass("has-success").addClass("has-error")},e}(o),t.exports=i},254:function(t,e,n){var i,o,r,a,s,l;i=n(12),o=n(9),l=n(15),r=l.renderable(function(t){return l.div(".form-group",function(){var e;return l.label(".control-label",{"for":t.input_id},t.label),(e=(null!=t?t.input_type:void 0)?l[t.input_type]:l.input)("#"+t.input_id+".form-control",t.input_attributes)})}),a=l.renderable(function(t){return l.form({role:"form",method:"POST",action:"/login"},function(){return r({input_id:"input_username",label:"User Name",input_attributes:{name:"username",placeholder:"User Name"}}),r({input_id:"input_password",label:"Password",input_attributes:{name:"password",type:"password",placeholder:"Type your password here...."}}),l.button(".btn.btn-default",{type:"submit"},"login")})}),s=l.renderable(function(t){return r({input_id:"input_name",label:"Name",input_attributes:{name:"name",placeholder:"Name"}}),r({input_id:"input_content",input_type:l.textarea,label:"Content",input_attributes:{name:"content",placeholder:"..."}}),l.input(".btn.btn-default.btn-xs",{type:"submit",value:"Add"})}),t.exports={form_group_input_div:r,login_form:a,name_content_form:s}},255:function(t,e,n){!function(e){t.exports=e(n(3),n(256))}(function(t,e){return t.Validation=function(t){"use strict";var e={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(t,n){return l[e.labelFormatter](t,n)},format:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return e.replace(/\{(\d+)\}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})}},i=function(e,n,o){return n=n||{},o=o||"",t.each(e,function(t,r){e.hasOwnProperty(r)&&(t&&"object"==typeof t&&!(t instanceof Date||t instanceof RegExp)?i(t,n,o+r+"."):n[o+r]=t)}),n},o=function(){var o=function(e){return t.reduce(t.keys(e.validation||{}),function(t,e){return t[e]=void 0,t},{})},a=function(e,n){var i=e.validation?e.validation[n]||{}:{};return(t.isFunction(i)||t.isString(i))&&(i={fn:i}),t.isArray(i)||(i=[i]),t.reduce(i,function(e,n){return t.each(t.without(t.keys(n),"msg"),function(t){e.push({fn:u[t],val:n[t],msg:n.msg})}),e},[])},s=function(e,i,o,r){return t.reduce(a(e,i),function(a,s){var l=t.extend({},n,u),c=s.fn.call(l,o,i,s.val,e,r);return c!==!1&&a!==!1&&(c&&!a?s.msg||c:a)},"")},l=function(e,n){var o,r={},a=!0,l=t.clone(n),u=i(n);return t.each(u,function(t,n){o=s(e,n,t,l),o&&(r[n]=o,a=!1)}),{invalidAttrs:r,isValid:a}},c=function(e,n){return{preValidate:function(e,n){return s(this,e,n,t.extend({},this.attributes))},isValid:function(e){var n=i(this.attributes);return t.isString(e)?!s(this,e,n[e],t.extend({},this.attributes)):t.isArray(e)?t.reduce(e,function(e,i){return e&&!s(this,i,n[i],t.extend({},this.attributes))},!0,this):(e===!0&&this.validate(),!this.validation||this._isValid)},validate:function(r,a){var s=this,u=!r,c=t.extend({},n,a),d=o(s),h=t.extend({},d,s.attributes,r),f=i(r||h),p=l(s,h);if(s._isValid=p.isValid,t.each(d,function(t,n){var i=p.invalidAttrs.hasOwnProperty(n);i||c.valid(e,n,c.selector)}),t.each(d,function(t,n){var i=p.invalidAttrs.hasOwnProperty(n),o=f.hasOwnProperty(n);i&&(o||u)&&c.invalid(e,n,p.invalidAttrs[n],c.selector)}),t.defer(function(){s.trigger("validated",s._isValid,s,p.invalidAttrs),s.trigger("validated:"+(s._isValid?"valid":"invalid"),s,p.invalidAttrs)}),!c.forceUpdate&&t.intersection(t.keys(p.invalidAttrs),t.keys(f)).length>0)return p.invalidAttrs}}},d=function(e,n,i){t.extend(n,c(e,i))},h=function(t){delete t.validate,delete t.preValidate,delete t.isValid},f=function(t){d(this.view,t,this.options)},p=function(t){h(t)};return{version:"0.7.1",configure:function(n){t.extend(e,n)},bind:function(n,i){var o=n.model,a=n.collection;if(i=t.extend({},e,r,i),"undefined"==typeof o&&"undefined"==typeof a)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";o?d(n,o,i):a&&(a.each(function(t){d(n,t,i)}),a.bind("add",f,{view:n,options:i}),a.bind("remove",p))},unbind:function(t){var e=t.model,n=t.collection;e&&h(t.model),n&&(n.each(function(t){h(t)}),n.unbind("add",f),n.unbind("remove",p))},mixin:c(null,e)}}(),r=o.callbacks={valid:function(t,e,n){t.$("["+n+'~="'+e+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(t,e,n,i){t.$("["+i+'~="'+e+'"]').addClass("invalid").attr("data-error",n)}},a=o.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},s=o.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},l=o.labelFormatters={none:function(t){return t},sentenceCase:function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toUpperCase():" "+t.toLowerCase()}).replace("_"," ")},label:function(t,e){return e.labels&&e.labels[t]||l.sentenceCase(t,e)}},u=o.validators=function(){var e=String.prototype.trim?function(t){return null===t?"":String.prototype.trim.call(t)}:function(t){var e=/^\s+/,n=/\s+$/;return null===t?"":t.toString().replace(e,"").replace(n,"")},n=function(e){return t.isNumber(e)||t.isString(e)&&e.match(a.number)},i=function(n){return!(t.isNull(n)||t.isUndefined(n)||t.isString(n)&&""===e(n))};return{fn:function(e,n,i,o,r){return t.isString(i)&&(i=o[i]),i.call(o,e,n,r)},required:function(e,n,o,r,a){var l=t.isFunction(o)?o.call(r,e,n,a):o;return!(!l&&!i(e))&&(l&&!i(e)?this.format(s.required,this.formatLabel(n,r)):void 0)},acceptance:function(e,n,i,o){if("true"!==e&&(!t.isBoolean(e)||e===!1))return this.format(s.acceptance,this.formatLabel(n,o))},min:function(t,e,i,o){if(!n(t)||t<i)return this.format(s.min,this.formatLabel(e,o),i)},max:function(t,e,i,o){if(!n(t)||t>i)return this.format(s.max,this.formatLabel(e,o),i)},range:function(t,e,i,o){if(!n(t)||t<i[0]||t>i[1])return this.format(s.range,this.formatLabel(e,o),i[0],i[1])},length:function(t,n,o,r){if(!i(t)||e(t).length!==o)return this.format(s.length,this.formatLabel(n,r),o)},minLength:function(t,n,o,r){if(!i(t)||e(t).length<o)return this.format(s.minLength,this.formatLabel(n,r),o)},maxLength:function(t,n,o,r){if(!i(t)||e(t).length>o)return this.format(s.maxLength,this.formatLabel(n,r),o)},rangeLength:function(t,n,o,r){if(!i(t)||e(t).length<o[0]||e(t).length>o[1])return this.format(s.rangeLength,this.formatLabel(n,r),o[0],o[1])},oneOf:function(e,n,i,o){if(!t.include(i,e))return this.format(s.oneOf,this.formatLabel(n,o),i.join(", "))},equalTo:function(t,e,n,i,o){if(t!==o[n])return this.format(s.equalTo,this.formatLabel(e,i),this.formatLabel(n,i))},pattern:function(t,e,n,o){if(!i(t)||!t.toString().match(a[n]||n))return this.format(s.pattern,this.formatLabel(e,o),n)}}}();return o}(e),t.Validation})},256:9,257:function(t,e,n){var i,o,r,a,s=function(t,e){return function(){return t.apply(e,arguments)}},l=function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty;a=n(9),o=n(8),r=n(255),i=function(t){function e(){this.invalid=s(this.invalid,this),this.valid=s(this.valid,this),e.__super__.constructor.apply(this,arguments),this.listenTo(this,"render",this.hideActivityIndicator),this.listenTo(this,"render",this.prepareModel),this.listenTo(this,"save:form:success",this.success),this.listenTo(this,"save:form:failure",this.failure)}return l(e,t),e.prototype.delegateEvents=function(t){return this.ui=a.extend(this._baseUI(),a.result(this,"ui")),this.events=a.extend(this._baseEvents(),a.result(this,"events")),e.__super__.delegateEvents.call(this,t)},e.prototype.tagName="form",e.prototype._baseUI=function(){return{submit:'input[type="submit"]',activityIndicator:".spinner"}},e.prototype._baseEvents=function(){var t;return t={"change [data-validation]":this.validateField,"blur [data-validation]":this.validateField,"keyup [data-validation]":this.validateField},t["click "+this.ui.submit]=this.processForm,t},e.prototype.createModel=function(){throw new Error("implement #createModel in your FormView subclass to return a Backbone model")},e.prototype.prepareModel=function(){return this.model=this.createModel(),this.setupValidation()},e.prototype.validateField=function(t){var e,n;return e=$(t.target).attr("data-validation"),n=$(t.target).val(),this.model.preValidate(e,n)?this.invalid(this,e):this.valid(this,e)},e.prototype.processForm=function(t){return t.preventDefault(),this.showActivityIndicator(),this.updateModel(),this.saveModel()},e.prototype.updateModel=function(){throw new Error("implement #updateModel in your FormView subclass to update the attributes of @model")},e.prototype.saveModel=function(){var t;return t={success:function(t){return function(){return t.trigger("save:form:success",t.model)}}(this),error:function(t){return function(){return t.trigger("save:form:failure",t.model)}}(this)},this.model.save({},t)},e.prototype.success=function(t){return this.render(),this.onSuccess(t)},e.prototype.onSuccess=function(t){return null},e.prototype.failure=function(t){return this.hideActivityIndicator(),this.onFailure(t)},e.prototype.onFailure=function(t){return null},e.prototype.showActivityIndicator=function(){return this.ui.activityIndicator.show(),this.ui.submit.hide()},e.prototype.hideActivityIndicator=function(){return this.ui.activityIndicator.hide(),this.ui.submit.show()},e.prototype.setupValidation=function(){return Backbone.Validation.unbind(this),Backbone.Validation.bind(this,{valid:this.valid,invalid:this.invalid})},e.prototype.valid=function(t,e,n){return this.$("[data-validation="+e+"]").removeClass("invalid").addClass("valid")},e.prototype.invalid=function(t,e,n,i){return this.failure(this.model),this.$("[data-validation="+e+"]").removeClass("valid").addClass("invalid")},e}(Backbone.Marionette.ItemView),t.exports=i},269:function(t,e,n){var i,o,r,a,s,l,u,c,d,h,f,p;f=n(15),c=n(136),h=n(134),d=h.navbar_collapse_button,a=h.dropdown_toggle,u=h.frontdoor_url,s=h.editor_url,p=n(135).workflow_dropdown,l=f.renderable(function(t){return f.raw(t.data.attributes.body)}),o=f.renderable(function(t){return f.article(".document-view.content",function(){return f.h1(t.title),f.div(".body",function(){var e;return e=t.content,"markdown"===t.doctype&&(e=c(e)),f.raw(e)})})}),r=f.renderable(function(t){var e,n;return e=t.data.attributes,n=t.data.relationships.meta,f.article(".document-view.content",function(){return f.h1(e.title),f.p(".lead",e.description),f.h2("Contents"),f.div(".body",function(){return f.table(".table.table-condensed",function(){return f.thead(function(){return f.tr(function(){return f.th("Title"),f.th("Type"),f.th("Creation Date"),f.th("Modification Date")})}),f.tbody(function(){var t,e,i,o,r,a,s;for(r=n.children,a=[],i=0,o=r.length;i<o;i++)t=r[i],s=t.data.relationships.meta.type_info,e=u(t.path),a.push(f.tr(function(){return f.td(function(){return f.a({href:e},t.data.attributes.title)}),f.td(function(){return f.a({href:e},s.title)}),f.td(function(){return f.a({href:e},t.meta.creation_date)}),f.td(function(){return f.a({href:e},t.meta.modification_date)})}));return a})})})})}),i=f.renderable(function(t){return f.article(".document-view.content",function(){return f.div(".body",function(){return f.raw(c(t.content))})})}),t.exports={frontdoor_main:l,DefaultViewTemplate:o,FolderViewTemplate:r,DefaultStaticDocumentTemplate:i}},271:function(t,e){!function(t){return t.widget("IKS.hallo",{toolbar:null,bound:!1,originalContent:"",previousContent:"",uuid:"",selection:null,_keepActivated:!1,originalHref:null,options:{editable:!0,plugins:{},toolbar:"halloToolbarContextual",parentElement:"body",buttonCssClass:null,toolbarCssClass:null,toolbarPositionAbove:!1,toolbarOptions:{},placeholder:"",forceStructured:!0,checkTouch:!0,touchScreen:null},_create:function(){var e,n,i;this.id=this._generateUUID(),this.options.checkTouch&&null===this.options.touchScreen&&this.checkTouch(),i=this.options.plugins;for(n in i)e=i[n],t.isPlainObject(e)||(e={}),t.extend(e,{editable:this,uuid:this.id,buttonCssClass:this.options.buttonCssClass}),t(this.element)[n](e);return this.element.one("halloactivated",function(t){return function(){return t._prepareToolbar()}}(this)),this.originalContent=this.getContents()},_init:function(){return this.options.editable?this.enable():this.disable()},destroy:function(){var e,n,i;this.disable(),this.toolbar&&(this.toolbar.remove(),this.element[this.options.toolbar]("destroy")),i=this.options.plugins;for(n in i)e=i[n],t(this.element)[n]("destroy");return t.Widget.prototype.destroy.call(this)},disable:function(){return this.element.attr("contentEditable",!1),this.element.off("focus",this._activated),this.element.off("blur",this._deactivated),this.element.off("keyup paste change",this._checkModified),this.element.off("keyup",this._keys),this.element.off("keyup mouseup",this._checkSelection),this.bound=!1,t(this.element).removeClass("isModified"),t(this.element).removeClass("inEditMode"),this.element.parents("a").andSelf().each(function(e){return function(n,i){var o;if(o=t(i),o.is("a")&&e.originalHref)return o.attr("href",e.originalHref)}}(this)),this._trigger("disabled",null)},enable:function(){return this.element.parents("a[href]").andSelf().each(function(e){return function(n,i){var o;if(o=t(i),o.is("a[href]"))return e.originalHref=o.attr("href"),o.removeAttr("href")}}(this)),this.element.attr("contentEditable",!0),this.element.html().trim()||(this.element.html(this.options.placeholder),this.element.css({"min-width":this.element.innerWidth(),"min-height":this.element.innerHeight()})),this.bound||(this.element.on("focus",this,this._activated),this.element.on("blur",this,this._deactivated),this.element.on("keyup paste change",this,this._checkModified),this.element.on("keyup",this,this._keys),this.element.on("keyup mouseup",this,this._checkSelection),this.bound=!0),this.options.forceStructured&&this._forceStructured(),this._trigger("enabled",null)},activate:function(){return this.element.focus()},containsSelection:function(){var t;return t=this.getSelection(),this.element.has(t.startContainer).length>0},getSelection:function(){var t,e;return e=rangy.getSelection(),t=null,t=e.rangeCount>0?e.getRangeAt(0):rangy.createRange()},restoreSelection:function(t){var e;return e=rangy.getSelection(),e.setSingleRange(t)},replaceSelection:function(t){var e,n,i,o,r;return"Microsoft Internet Explorer"===navigator.appName?(r=document.selection.createRange().text,n=document.selection.createRange(),n.pasteHTML(t(r))):(o=window.getSelection(),i=o.getRangeAt(0),e=document.createTextNode(t(i.extractContents())),i.insertNode(e),i.setStartAfter(e),o.removeAllRanges(),o.addRange(i))},removeAllSelections:function(){return"Microsoft Internet Explorer"===navigator.appName?range.empty():window.getSelection().removeAllRanges()},getContents:function(){var e,n,i;n=this.element.clone();for(i in this.options.plugins)e=t(this.element).data("IKS-"+i).cleanupContentClone,t.isFunction(e)&&t(this.element)[i]("cleanupContentClone",n);return n.html()},setContents:function(t){return this.element.html(t)},isModified:function(){return this.previousContent||(this.previousContent=this.originalContent),this.previousContent!==this.getContents()},setUnmodified:function(){return t(this.element).removeClass("isModified"),this.previousContent=this.getContents()},setModified:function(){return t(this.element).addClass("isModified"),this._trigger("modified",null,{editable:this,content:this.getContents()})},restoreOriginalContent:function(){return this.element.html(this.originalContent)},execute:function(t,e){if(document.execCommand(t,!1,e))return this.element.trigger("change")},protectFocusFrom:function(t){return t.on("mousedown",function(t){return function(e){return e.preventDefault(),t._protectToolbarFocus=!0,setTimeout(function(){return t._protectToolbarFocus=!1},300)}}(this))},keepActivated:function(t){this._keepActivated=t},_generateUUID:function(){var t;return t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},""+t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},_prepareToolbar:function(){var e,n,i,o;this.toolbar=t('<div class="hallotoolbar"></div>').hide(),
this.options.toolbarCssClass&&this.toolbar.addClass(this.options.toolbarCssClass),e={editable:this,parentElement:this.options.parentElement,toolbar:this.toolbar,positionAbove:this.options.toolbarPositionAbove},o=$.extend({},e,this.options.toolbarOptions),this.element[this.options.toolbar](o);for(n in this.options.plugins)i=t(this.element).data("IKS-"+n).populateToolbar,t.isFunction(i)&&this.element[n]("populateToolbar",this.toolbar);return this.element[this.options.toolbar]("setPosition"),this.protectFocusFrom(this.toolbar)},changeToolbar:function(t,e,n){var i;if(null==n&&(n=!1),i=this.options.toolbar,this.options.parentElement=t,e&&(this.options.toolbar=e),this.toolbar)return this.element[i]("destroy"),this.toolbar.remove(),this._prepareToolbar(),n?this.toolbar.hide():void 0},_checkModified:function(t){var e;if(e=t.data,e.isModified())return e.setModified()},_keys:function(t){var e,n;if(n=t.data,27===t.keyCode)return e=n.getContents(),n.restoreOriginalContent(t),n._trigger("restored",null,{editable:n,content:n.getContents(),thrown:e}),n.turnOff()},_rangesEqual:function(t,e){return t.startContainer===e.startContainer&&(t.startOffset===e.startOffset&&(t.endContainer===e.endContainer&&t.endOffset===e.endOffset))},_checkSelection:function(t){var e;if(27!==t.keyCode)return e=t.data,setTimeout(function(){var n;return n=e.getSelection(),e._isEmptySelection(n)||e._isEmptyRange(n)?void(e.selection&&(e.selection=null,e._trigger("unselected",null,{editable:e,originalEvent:t}))):e.selection&&e._rangesEqual(n,e.selection)?void 0:(e.selection=n.cloneRange(),e._trigger("selected",null,{editable:e,selection:e.selection,ranges:[e.selection],originalEvent:t}))},0)},_isEmptySelection:function(t){return"Caret"===t.type},_isEmptyRange:function(t){return!!t.collapsed||!!t.isCollapsed&&("function"==typeof t.isCollapsed?t.isCollapsed():t.isCollapsed)},turnOn:function(){return this.getContents()===this.options.placeholder&&this.setContents(""),t(this.element).addClass("inEditMode"),this._trigger("activated",null,this)},turnOff:function(){if(t(this.element).removeClass("inEditMode"),this._trigger("deactivated",null,this),!this.getContents())return this.setContents(this.options.placeholder)},_activated:function(t){return t.data.turnOn()},_deactivated:function(e){if(!e.data._keepActivated)return e.data._protectToolbarFocus!==!0?e.data.turnOff():setTimeout(function(){return t(e.data.element).focus()},300)},_forceStructured:function(t){var e,n,i,o;try{return document.execCommand("styleWithCSS",0,!1)}catch(n){e=n;try{return document.execCommand("useCSS",0,!0)}catch(i){e=i;try{return document.execCommand("styleWithCSS",!1,!1)}catch(o){e=o}}}},checkTouch:function(){return this.options.touchScreen=!!("createTouch"in document)}})}(jQuery)},272:function(t,e){!function(t){return t.widget("IKS.halloblacklist",{options:{tags:[]},_init:function(){if(this.options.tags.indexOf("br")!==-1)return this.element.on("keydown",function(t){if(13===t.originalEvent.keyCode)return t.preventDefault()})},cleanupContentClone:function(e){var n,i,o,r,a;for(o=this.options.tags,r=[],n=0,i=o.length;n<i;n++)a=o[n],r.push(t(a,e).remove());return r}})}(jQuery)},273:function(t,e){!function(t){return t.widget("IKS.halloformat",{options:{editable:null,uuid:"",formattings:{bold:!0,italic:!0,strikeThrough:!1,underline:!1},buttonCssClass:null},populateToolbar:function(e){var n,i,o,r,a,s;s=this,i=t('<span class="'+s.widgetName+'"></span>'),n=function(e){return function(n){var o;return o=t("<span></span>"),o.hallobutton({label:n,editable:e.options.editable,command:n,uuid:e.options.uuid,cssClass:e.options.buttonCssClass}),i.append(o)}}(this),a=this.options.formattings;for(r in a)o=a[r],o&&n(r);return i.hallobuttonset(),e.append(i)}})}(jQuery)},274:function(t,e){!function(t){return t.widget("IKS.halloheadings",{options:{editable:null,uuid:"",formatBlocks:["p","h1","h2","h3"],buttonCssClass:null},populateToolbar:function(e){var n,i,o,r,a,s,l,u,c;for(c=this,i=t('<span class="'+c.widgetName+'"></span>'),s="Microsoft Internet Explorer"===navigator.appName,o=s?"FormatBlock":"formatBlock",n=function(e){return function(n){var r;return r=t("<span></span>"),r.hallobutton({label:n,editable:e.options.editable,command:o,commandValue:s?"<"+n+">":n,uuid:e.options.uuid,cssClass:e.options.buttonCssClass,queryState:function(t){var e,i,a,l,u,c,d,h,f,p;try{if(p=document.queryCommandValue(o),s){for(c={p:"normal"},d=[1,2,3,4,5,6],l=0,u=d.length;l<u;l++)f=d[l],c["h"+f]=f;e=p.match(new RegExp(c[n],"i"))}else e=p.match(new RegExp(n,"i"));return h=!!e,r.hallobutton("checked",h)}catch(a){i=a}}}),r.find("button .ui-button-text").text(n.toUpperCase()),i.append(r)}}(this),u=this.options.formatBlocks,a=0,l=u.length;a<l;a++)r=u[a],n(r);return i.hallobuttonset(),e.append(i)}})}(jQuery)},275:function(t,e){!function(t){return t.widget("IKS.halloimage",{options:{editable:null,toolbar:null,uuid:"",limit:8,search:null,searchUrl:null,suggestions:null,loaded:null,upload:null,uploadUrl:null,dialogOpts:{autoOpen:!1,width:270,height:"auto",title:"Insert Images",modal:!1,resizable:!1,draggable:!0,dialogClass:"halloimage-dialog"},dialog:null,buttonCssClass:null,entity:null,vie:null,dbPediaUrl:"http://dev.iks-project.eu/stanbolfull",maxWidth:250,maxHeight:250},populateToolbar:function(e){var n,i,o,r,a,s,l;return this.options.toolbar=e,l=this,o=this.options.uuid+"-image-dialog",this.options.dialog=t('<div id="'+o+'"> <div class="nav"> <ul class="tabs"> </ul> <div id="'+this.options.uuid+'-tab-activeIndicator" class="tab-activeIndicator" /> </div> <div class="dialogcontent"> </div>'),s=t(".tabs",this.options.dialog),a=t(".dialogcontent",this.options.dialog),l.options.suggestions&&this._addGuiTabSuggestions(s,a),(l.options.search||l.options.searchUrl)&&this._addGuiTabSearch(s,a),(l.options.upload||l.options.uploadUrl)&&this._addGuiTabUpload(s,a),this.current=t('<div class="currentImage"></div>').halloimagecurrent({uuid:this.options.uuid,imageWidget:this,editable:this.options.editable,dialog:this.options.dialog,maxWidth:this.options.maxWidth,maxHeight:this.options.maxHeight}),t(".dialogcontent",this.options.dialog).append(this.current),i=t('<span class="'+l.widgetName+'"></span>'),r=this.options.uuid+"-image",n=t("<span></span>"),n.hallobutton({label:"Images",icon:"icon-picture",editable:this.options.editable,command:null,queryState:!1,uuid:this.options.uuid,cssClass:this.options.buttonCssClass}),i.append(n),this.button=n,this.button.on("click",function(t){return l.options.dialog.dialog("isOpen")?l._closeDialog():l._openDialog(),!1}),this.options.editable.element.on("hallodeactivated",function(t){return l._closeDialog()}),t(this.options.editable.element).delegate("img","click",function(t){return l._openDialog()}),e.append(i),this.options.dialog.dialog(this.options.dialogOpts),this._handleTabs()},setCurrent:function(t){return this.current.halloimagecurrent("setImage",t)},_handleTabs:function(){var e;return e=this,t(".nav li",this.options.dialog).on("click",function(){var n,i;return t("."+e.widgetName+"-tab").hide(),n=t(this).attr("id"),t("#"+n+"-content").show(),i=t(this).position().left+t(this).width()/2,t("#"+e.options.uuid+"-tab-activeIndicator").css({"margin-left":i})}),t(".nav li",this.options.dialog).first().click()},_openDialog:function(){var e,n,i,o,r,a,s,l;return a=this,e=function(){return window.setTimeout(function(){var e;return e=t(".imageThumbnail"),t(e).each(function(){var e;if(e=t("#"+this.id).width(),e<=20)return t("#"+this.id).parent("li").remove()})},15e3)},o="#"+this.options.uuid+"-tab-suggestions-content",i=function(){return t(".imageThumbnailActive",o).first().attr("src")},t("#"+this.options.uuid+"-sugg-activeImage").attr("src",i()),t("#"+this.options.uuid+"-sugg-activeImageBg").attr("src",i()),this.lastSelection=this.options.editable.getSelection(),n=t(this.options.editable.element),r=t(this.options.toolbar),s=n.offset().left+n.outerWidth()-3,l=r.offset().top+r.outerHeight()+29,l-=t(document).scrollTop(),this.options.dialog.dialog("option","position",[s,l]),e(),a.options.loaded=1,this.options.editable.keepActivated(!0),this.options.dialog.dialog("open"),this.options.dialog.on("dialogclose",function(e){return function(){return t("label",e.button).removeClass("ui-state-active"),e.options.editable.element.focus(),e.options.editable.keepActivated(!1)}}(this))},_closeDialog:function(){return this.options.dialog.dialog("close")},_addGuiTabSuggestions:function(e,n){var i;return e.append(t('<li id="'+this.options.uuid+'-tab-suggestions" class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-suggestions"> <span>Suggestions</span> </li>')),i=t('<div id="'+this.options.uuid+'-tab-suggestions-content" class="'+this.widgetName+'-tab tab-suggestions"></div>'),n.append(i),i.halloimagesuggestions({uuid:this.options.uuid,imageWidget:this,entity:this.options.entity})},_addGuiTabSearch:function(e,n){var i,o,r;return r=this,i=this.options.uuid+"-image-dialog",e.append(t('<li id="'+this.options.uuid+'-tab-search" class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-search"> <span>Search</span> </li>')),o=t('<div id="'+this.options.uuid+'-tab-search-content" class="'+r.widgetName+'-tab tab-search"></div>'),n.append(o),o.halloimagesearch({uuid:this.options.uuid,imageWidget:this,searchCallback:this.options.search,searchUrl:this.options.searchUrl,limit:this.options.limit,entity:this.options.entity})},_addGuiTabUpload:function(e,n){var i;return e.append(t('<li id="'+this.options.uuid+'-tab-upload" class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-upload"> <span>Upload</span> </li>')),i=t('<div id="'+this.options.uuid+'-tab-upload-content" class="'+this.widgetName+'-tab tab-upload"></div>'),n.append(i),i.halloimageupload({uuid:this.options.uuid,uploadCallback:this.options.upload,uploadUrl:this.options.uploadUrl,imageWidget:this,entity:this.options.entity})}})}(jQuery)},276:function(t,e){!function(t){return t.widget("IKS.halloimagecurrent",{options:{imageWidget:null,startPlace:"",draggables:[],maxWidth:400,maxHeight:200},_create:function(){return this.element.html('<div> <div class="activeImageContainer"> <div class="rotationWrapper"> <div class="hintArrow"></div> <img src="" class="activeImage" /> </div> <img src="" class="activeImage activeImageBg" /> </div> </div>'),this.element.hide(),this._prepareDnD()},_init:function(){var e,n;return e=t(this.options.editable.element),n=this,t("img",e).each(function(t,i){return n._initDraggable(i,e)}),t("p",e).each(function(e,i){if(!t(i).data("jquery_droppable_initialized"))return t(i).droppable({tolerance:"pointer",drop:function(t,e){return n._handleDropEvent(t,e)},over:function(t,e){return n._handleOverEvent(t,e)},out:function(t,e){return n._handleLeaveEvent(t,e)}}),t(i).data("jquery_droppable_initialized",!0)})},_prepareDnD:function(){var e,n,i;return i=this,e=t(this.options.editable.element),this.options.offset=e.offset(),this.options.third=parseFloat(e.width()/3),n={width:this.options.third,height:e.height()},this.overlay={big:t("<div/>").addClass("bigOverlay").css({width:2*this.options.third,height:e.height()}),left:t("<div/>").addClass("smallOverlay smallOverlayLeft"),right:t("<div/>").addClass("smallOverlay smallOverlayRight")},this.overlay.left.css(n),this.overlay.right.css(n).css("left",2*this.options.third),e.on("halloactivated",function(){return i._enableDragging()}),e.on("hallodeactivated",function(){return i._disableDragging()})},setImage:function(e){if(e)return this.element.show(),t(".activeImage",this.element).attr("src",e.url),e.label&&t("input",this.element).val(e.label),this._initImage(t(this.options.editable.element))},_delayAction:function(t,e){var n;if(n=clearTimeout(n),!n)return n=setTimeout(t,e)},_calcDropPosition:function(t,e){var n,i;return n=t.left+this.options.third,i=t.left+2*this.options.third,e.pageX>=n&&e.pageX<=i?"middle":e.pageX<n?"left":e.pageX>i?"right":void 0},_createInsertElement:function(e,n){var i,o;return i=t("<img>"),o=new Image,t(o).on("load",function(){}),o.src=e.src,i.attr({src:o.src,alt:n?void 0:t(e).attr("alt"),"class":n?"halloTmp":"imageInText"}),i.show(),i},_createLineFeedbackElement:function(){return t("<div/>").addClass("halloTmpLine")},_removeFeedbackElements:function(){return this.overlay.big.remove(),this.overlay.left.remove(),this.overlay.right.remove(),t(".halloTmp, .halloTmpLine",this.options.editable.element).remove()},_removeCustomHelper:function(){return t(".customHelper").remove()},_showOverlay:function(e){var n,i;switch(i=t(this.options.editable.element),n=i.height(),n+=parseFloat(i.css("paddingTop")),n+=parseFloat(i.css("paddingBottom")),this.overlay.big.css({height:n}),this.overlay.left.css({height:n}),this.overlay.right.css({height:n}),e){case"left":return this.overlay.big.addClass("bigOverlayLeft"),this.overlay.big.removeClass("bigOverlayRight"),this.overlay.big.css({left:this.options.third}),this.overlay.big.show(),this.overlay.left.hide(),this.overlay.right.hide();case"middle":return this.overlay.big.removeClass("bigOverlayLeft bigOverlayRight"),this.overlay.big.hide(),this.overlay.left.show(),this.overlay.right.show();case"right":return this.overlay.big.addClass("bigOverlayRight"),this.overlay.big.removeClass("bigOverlayLeft"),this.overlay.big.css({left:0}),this.overlay.big.show(),this.overlay.left.hide(),this.overlay.right.hide()}},_checkOrigin:function(e){return 0!==t(e.target).parents("[contenteditable]").length},_createFeedback:function(t,e){var n;return"middle"===e?this._createLineFeedbackElement():(n=this._createInsertElement(t,!0),n.addClass("inlineImage-"+e))},_handleOverEvent:function(e,n){var i,o,r;return r=this,i=t(this.options.editable),o=function(){var o,a;return window.waitWithTrash=clearTimeout(window.waitWithTrash),o=r._calcDropPosition(r.options.offset,e),t(".trashcan",n.helper).remove(),i[0].element.append(r.overlay.big),i[0].element.append(r.overlay.left),i[0].element.append(r.overlay.right),r._removeFeedbackElements(),a=t(e.target),a.prepend(r._createFeedback(n.draggable[0],o)),"middle"===o?(a.prepend(r._createFeedback(n.draggable[0],"right")),t(".halloTmp",e.target).hide()):(a.prepend(r._createFeedback(n.draggable[0],"middle")),t(".halloTmpLine",e.target).hide()),r._showOverlay(o)},setTimeout(o,5)},_handleDragEvent:function(e,n){var i,o,r;if(i=this._calcDropPosition(this.options.offset,e),i!==this._lastPositionDrag)return this._lastPositionDrag=i,o=t(".halloTmp",this.options.editable.element),r=t(".halloTmpLine",this.options.editable.element),"middle"===i?(r.show(),o.hide()):(r.hide(),o.removeClass("inlineImage-left inlineImage-right"),o.addClass("inlineImage-"+i),o.show()),this._showOverlay(i)},_handleLeaveEvent:function(e,n){var i;return i=function(){if(!t("div.trashcan",n.helper).length)return t(n.helper).append(t('<div class="trashcan"></div>')),t(".bigOverlay, .smallOverlay").remove()},window.waitWithTrash=setTimeout(i,200),this._removeFeedbackElements()},_handleStartEvent:function(e,n){var i;return i=this._checkOrigin(e),i&&t(e.target).remove(),t(document).trigger("startPreventSave"),this.options.startPlace=t(e.target)},_handleStopEvent:function(e,n){var i;return i=this._checkOrigin(e),i?t(e.target).remove():t(this.options.editable.element).trigger("change"),this.overlay.big.hide(),this.overlay.left.hide(),this.overlay.right.hide(),t(document).trigger("stopPreventSave")},_handleDropEvent:function(e,n){var i,o,r,a,s,l;return o=t(this.options.editable.element),a=this._checkOrigin(e),l=this._calcDropPosition(this.options.offset,e),this._removeFeedbackElements(),this._removeCustomHelper(),r=this._createInsertElement(n.draggable[0],!1),i="inlineImage-middle inlineImage-left inlineImage-right","middle"===l?(r.show(),r.removeClass(i),s=o.width(),s+=parseFloat(o.css("paddingLeft")),s+=parseFloat(o.css("paddingRight")),s-=r.attr("width"),r.addClass("inlineImage-"+l).css({position:"relative",left:s/2}),r.insertBefore(t(e.target))):(r.removeClass(i),r.addClass("inlineImage-"+l),r.css("display","block"),t(e.target).prepend(r)),this.overlay.big.hide(),this.overlay.left.hide(),this.overlay.right.hide(),o.trigger("change"),this._initImage(o)},_createHelper:function(e){return t("<div>").css({backgroundImage:"url("+t(e.currentTarget).attr("src")+")"}).addClass("customHelper").appendTo("body")},_initDraggable:function(e,n){var i;return i=this,e.jquery_draggable_initialized||(e.jquery_draggable_initialized=!0,t(e).draggable({cursor:"move",helper:function(t){return i._createHelper(t)},drag:function(t,e){return i._handleDragEvent(t,e)},start:function(t,e){return i._handleStartEvent(t,e)},stop:function(t,e){return i._handleStopEvent(t,e)},disabled:!n.hasClass("inEditMode"),cursorAt:{top:50,left:50}})),i.options.draggables.push(e)},_initImage:function(e){var n;return n=this,t(".rotationWrapper img",this.options.dialog).each(function(t,i){return n._initDraggable(i,e)})},_enableDragging:function(){return t.each(this.options.draggables,function(e,n){return t(n).draggable("option","disabled",!1)})},_disableDragging:function(){return t.each(this.options.draggables,function(e,n){return t(n).draggable("option","disabled",!0)})}})}(jQuery)},277:function(t,e){$.widget("ncri.hallo-image-insert-edit",{options:{editable:null,toolbar:null,uuid:"",insert_file_dialog_ui_url:null,lang:"en",dialogOpts:{autoOpen:!1,width:560,height:"auto",modal:!1,resizable:!0,draggable:!0,dialogClass:"insert-image-dialog"},dialog:null,buttonCssClass:null},translations:{en:{title_insert:"Insert Image",title_properties:"Image Properties",insert:"Insert",chage_image:"Change Image:",source:"URL",width:"Width",height:"Height",alt:"Alt Text",padding:"Padding","float":"Float",float_left:"left",float_right:"right",float_none:"No"},de:{title_insert:"Bild einfügen",title_properties:"Bildeigenschaften",insert:"Einfügen",chage_image:"Bild ändern:",source:"URL",width:"Breite",height:"Höhe",alt:"Alt Text",padding:"Padding","float":"Float",float_left:"Links",float_right:"Rechts",float_none:"Nein"}},texts:null,dialog_image_selection_ui_loaded:!1,$image:null,populateToolbar:function(t){var e,n,i,o;return o=this,this.texts=this.translations[this.options.lang],this.options.toolbar=t,i="<div id='hallo_img_properties'></div>",this.options.insert_file_dialog_ui_url&&(i+="<div id='hallo_img_file_select_ui'></div>"),this.options.dialog=$("<div>").attr("id",this.options.uuid+"-insert-image-dialog").html(i),n=$("<span>").addClass(this.widgetName),e=$("<span>"),e.hallobutton({label:this.texts.title_insert,icon:"icon-picture",editable:this.options.editable,command:null,queryState:!1,uuid:this.options.uuid,cssClass:this.options.buttonCssClass}),n.append(e),this.button=e,this.button.click(function(){return o.options.dialog.dialog("isOpen")?o._closeDialog():(o.lastSelection=o.options.editable.getSelection(),o._openDialog()),!1}),this.options.editable.element.on("halloselected, hallounselected",function(){if(o.options.dialog.dialog("isOpen"))return o.lastSelection=o.options.editable.getSelection()}),this.options.editable.element.on("hallodeactivated",function(){return o._closeDialog()}),$(this.options.editable.element).on("click","img",function(t){return o._openDialog($(this)),!1}),this.options.editable.element.on("halloselected",function(e,n){var i;if(i=o.options.editable.options.toolbar,"halloToolbarContextual"===i&&$(n.originalEvent.target).is("img"))return t.hide(),!1}),t.append(n),this.options.dialog.dialog(this.options.dialogOpts)},_openDialog:function(t){var e,n,i,o;if(this.$image=t,n=this,e=$(this.options.editable.element),i=e.offset().left+e.outerWidth()+10,o=this.$image?this.$image.offset().top-$(document).scrollTop():this.options.toolbar.offset().top-$(document).scrollTop(),this.options.dialog.dialog("option","position",[i,o]),this.options.editable.keepActivated(!0),this.options.dialog.dialog("open"),this.$image?(this.options.dialog.dialog("option","title",this.texts.title_properties),$(document).keyup(function(t){return 46!==t.keyCode&&8!==t.keyCode||($(document).off(),n._closeDialog(),n.$image.remove(),n.$image=null),t.preventDefault()}),this.options.editable.element.on("click",function(){return n.$image=null,n._closeDialog()})):(this.options.dialog.children("#hallo_img_properties").hide(),this.options.dialog.dialog("option","title",this.texts.title_insert),$("#hallo_img_file_select_title").length>0&&$("#hallo_img_file_select_title").text("")),this._load_dialog_image_properties_ui(),this.options.dialog.on("dialogclose",function(t){return function(){var e;return $("label",t.button).removeClass("ui-state-active"),e=$(document).scrollTop(),t.options.editable.element.focus(),$(document).scrollTop(e),t.options.editable.keepActivated(!1)}}(this)),this.options.insert_file_dialog_ui_url&&!this.dialog_image_selection_ui_loaded)return this.options.dialog.on("click",".reload_link",function(){return n._load_dialog_image_selection_ui(),!1}),this.options.dialog.on("click",".file_preview img",function(){var t;return n.$image?(t=$(this).attr("src").replace(/-thumb/,""),n.$image.attr("src",t),$("#hallo_img_source").val(t)):n._insert_image($(this).attr("src").replace(/-thumb/,"")),!1}),this._load_dialog_image_selection_ui()},_insert_image:function(t){return this.options.editable.restoreSelection(this.lastSelection),document.execCommand("insertImage",null,t),this.options.editable.element.trigger("change"),this.options.editable.removeAllSelections(),this._closeDialog()},_closeDialog:function(){return this.options.dialog.dialog("close")},_load_dialog_image_selection_ui:function(){var t;return t=this,$.ajax({url:this.options.insert_file_dialog_ui_url,success:function(e,n,i){var o,r,a;return r="",o=t.options.dialog.children("#hallo_img_properties"),o.is(":visible")&&(r=t.texts.change_image),a="<div id='hallo_img_file_select_title'>"+r+"</div>",t.options.dialog.children("#hallo_img_file_select_ui").html(a+e),t.dialog_image_selection_ui_loaded=!0},beforeSend:function(){return t.options.dialog.children("#hallo_img_file_select_ui").html('<div class="hallo_insert_file_loader"></div>')}})},_load_dialog_image_properties_ui:function(){var t,e,n,i,o,r;return o=this,t=this.options.dialog.children("#hallo_img_properties"),this.$image?(r=this.$image.is("[width]")?this.$image.attr("width"):"",n=this.$image.is("[height]")?this.$image.attr("height"):"",i=this._property_input_html("source",this.$image.attr("src"),{label:this.texts.source})+this._property_input_html("alt",this.$image.attr("alt")||"",{label:this.texts.alt})+this._property_row_html(this._property_input_html("width",r,{label:this.texts.width,row:!1})+this._property_input_html("height",n,{label:this.texts.height,row:!1}))+this._property_input_html("padding",this.$image.css("padding"),{label:this.texts.padding})+this._property_row_html(this._property_cb_html("float_left","left"===this.$image.css("float"),{label:this.texts.float_left,row:!1})+this._property_cb_html("float_right","right"===this.$image.css("float"),{label:this.texts.float_right,row:!1})+this._property_cb_html("unfloat","none"===this.$image.css("float"),{label:this.texts.float_none,row:!1}),this.texts["float"]),t.html(i),t.show()):this.options.insert_file_dialog_ui_url||(t.html(this._property_input_html("source","",{label:this.texts.source})),t.show()),this.$image?(this.options.insert_file_dialog_ui_url||$("#insert_image_btn").remove(),$("#hallo_img_file_select_title").length>0&&$("#hallo_img_file_select_title").text(this.texts.chage_image),$("#hallo_img_properties #hallo_img_source").keyup(function(){return o.$image.attr("src",this.value)}),$("#hallo_img_properties #hallo_img_alt").keyup(function(){return o.$image.attr("alt",this.value)}),$("#hallo_img_properties #hallo_img_padding").keyup(function(){return o.$image.css("padding",this.value)}),$("#hallo_img_properties #hallo_img_height").keyup(function(){return o.$image.css("height",this.value),o.$image.attr("height",this.value)}),$("#hallo_img_properties #hallo_img_width").keyup(function(){return o.$image.css("width",this.value),o.$image.attr("width",this.value)}),$("#hallo_img_properties #hallo_img_float_left").click(function(){return!!this.checked&&(o.$image.css("float","left"),$("#hallo_img_properties #hallo_img_float_right").removeAttr("checked"),$("#hallo_img_properties #hallo_img_unfloat").removeAttr("checked"))}),$("#hallo_img_properties #hallo_img_float_right").click(function(){return!!this.checked&&(o.$image.css("float","right"),$("#hallo_img_properties #hallo_img_unfloat").removeAttr("checked"),$("#hallo_img_properties #hallo_img_float_left").removeAttr("checked"))}),$("#hallo_img_properties #hallo_img_unfloat").click(function(){return!!this.checked&&(o.$image.css("float","none"),$("#hallo_img_properties #hallo_img_float_right").removeAttr("checked"),$("#hallo_img_properties #hallo_img_float_left").removeAttr("checked"))})):this.options.insert_file_dialog_ui_url?void 0:(e='<button id="insert_image_btn">'+this.texts.insert+"</button>",t.after(e),$("#insert_image_btn").click(function(){var t;return t=$("#hallo_img_properties #hallo_img_source"),o._insert_image(t.val())}))},_property_col_html:function(t){return"<div class='hallo_img_property_col'>"+t+"</div>"},_property_row_html:function(t,e){return null==e&&(e=""),t=this._property_col_html(e)+this._property_col_html(t),"<div class='hallo_img_property_row'>"+t+"</div>"},_property_html:function(t,e){var n;return null==e&&(e={}),e.row===!1?(e.label&&(n=e.label+" "+t,t="<span class='img_property_entry'>"+n+"</span>"),t):(n="<span class='img_property_entry'>"+t+"</span>",this._property_row_html(n,e.label))},_property_input_html:function(t,e,n){var i;return null==n&&(n={}),i="<input type='text' id='hallo_img_"+t+"' value='"+e+"'>",this._property_html(i,n)},_property_cb_html:function(t,e,n){var i,o;return null==n&&(n={}),o=e?"checked=checked":"",i="<input type='checkbox' id='hallo_img_"+t+"' "+o+"'>",this._property_html(i,n)}})},278:function(t,e){!function(t){return t.widget("IKS.hallojustify",{options:{editable:null,toolbar:null,uuid:"",buttonCssClass:null},populateToolbar:function(e){var n,i;return i=t('<span class="'+this.widgetName+'"></span>'),n=function(e){return function(n){var o;return o=t("<span></span>"),o.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:n,command:"justify"+n,icon:"icon-align-"+n.toLowerCase(),cssClass:e.options.buttonCssClass}),i.append(o)}}(this),n("Left"),n("Center"),n("Right"),i.hallobuttonset(),e.append(i)}})}(jQuery)},279:function(t,e){!function(t){return t.widget("IKS.hallolink",{options:{editable:null,uuid:"",link:!0,image:!0,defaultUrl:"http://",dialogOpts:{autoOpen:!1,width:540,height:95,title:"Enter Link",buttonTitle:"Insert",buttonUpdateTitle:"Update",modal:!0,resizable:!1,draggable:!1,dialogClass:"hallolink-dialog"},buttonCssClass:null},populateToolbar:function(e){var n,i,o,r,a,s,l,u,c,d;if(d=this,s=this.options.uuid+"-dialog",n=this.options.dialogOpts.buttonTitle,i=this.options.dialogOpts.buttonUpdateTitle,a=t('<div id="'+s+'"> <form action="#" method="post" class="linkForm"> <input class="url" type="text" name="url" value="'+this.options.defaultUrl+'" /> <input type="submit" id="addlinkButton" value="'+n+'"/> </form></div>'),c=t("input[name=url]",a).focus(function(t){return this.select()}),u=function(t){return!!new RegExp(/^\s*$/).test(t)||t===d.options.defaultUrl},l=function(t){var e,n;return t.preventDefault(),e=c.val(),d.options.editable.restoreSelection(d.lastSelection),u(e)?(n=d.lastSelection.startContainer,d.lastSelection.collapsed&&(d.lastSelection.setStartBefore(n),d.lastSelection.setEndAfter(n),window.getSelection().addRange(d.lastSelection)),document.execCommand("unlink",null,"")):(/:\/\//.test(e)||/^mailto:/.test(e)||(e="http://"+e),void 0===d.lastSelection.startContainer.parentNode.href?document.execCommand("createLink",null,e):d.lastSelection.startContainer.parentNode.href=e),d.options.editable.element.trigger("change"),d.options.editable.removeAllSelections(),a.dialog("close"),!1},a.find("input[type=submit]").click(l),r=t('<span class="'+d.widgetName+'"></span>'),o=function(e){return function(o){var s,l,u;return u=e.options.uuid+"-"+o,l=t("<span></span>"),l.hallobutton({label:"Link",icon:"icon-link",editable:e.options.editable,command:null,queryState:!1,uuid:e.options.uuid,cssClass:e.options.buttonCssClass}),r.append(l),s=l,s.on("click",function(e){var o,r;return d.lastSelection=d.options.editable.getSelection(),c=t("input[name=url]",a),r=d.lastSelection.startContainer.parentNode,r.href?(c.val(t(r).attr("href")),o="input[type=submit]",t(c[0].form).find(o).val(i)):(c.val(d.options.defaultUrl),t(c[0].form).find("input[type=submit]").val(n)),d.options.editable.keepActivated(!0),a.dialog("open"),a.on("dialogclose",function(){return t("label",l).removeClass("ui-state-active"),d.options.editable.element.focus(),d.options.editable.keepActivated(!1)}),!1}),e.element.on("keyup paste change mouseup",function(e){var n,i;return i=t(d.options.editable.getSelection().startContainer),n=i.prop("nodeName")?i.prop("nodeName"):i.parent().prop("nodeName"),n&&"A"===n.toUpperCase()?void t("label",s).addClass("ui-state-active"):t("label",s).removeClass("ui-state-active")})}}(this),this.options.link&&o("A"),this.options.link)return e.append(r),r.hallobuttonset(),a.dialog(this.options.dialogOpts)}})}(jQuery)},280:function(t,e){!function(t){return t.widget("IKS.hallolists",{options:{editable:null,toolbar:null,uuid:"",lists:{ordered:!0,unordered:!0},buttonCssClass:null},populateToolbar:function(e){var n,i;return i=t('<span class="'+this.widgetName+'"></span>'),n=function(e){return function(n,o){var r;return r=t("<span></span>"),r.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:o,command:"insert"+n+"List",icon:"icon-list-"+o.toLowerCase(),cssClass:e.options.buttonCssClass}),i.append(r)}}(this),this.options.lists.ordered&&n("Ordered","OL"),this.options.lists.unordered&&n("Unordered","UL"),i.hallobuttonset(),e.append(i)}})}(jQuery)},281:function(t,e){!function(t){return t.widget("IKS.halloreundo",{options:{editable:null,toolbar:null,uuid:"",buttonCssClass:null},populateToolbar:function(e){var n,i;return i=t('<span class="'+this.widgetName+'"></span>'),n=function(e){return function(n,o){var r;return r=t("<span></span>"),r.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:o,icon:"undo"===n?"icon-undo":"icon-repeat",command:n,queryState:!1,cssClass:e.options.buttonCssClass}),i.append(r)}}(this),n("undo","Undo"),n("redo","Redo"),i.hallobuttonset(),e.append(i)}})}(jQuery)},282:function(t,e){!function(t){return t.widget("IKS.halloToolbarContextual",{toolbar:null,options:{parentElement:"body",editable:null,toolbar:null,positionAbove:!1},_create:function(){return this.toolbar=this.options.toolbar,t(this.options.parentElement).append(this.toolbar),this._bindEvents(),t(window).resize(function(t){return function(e){return t._updatePosition(t._getPosition(e))}}(this))},_getPosition:function(t,e){var n,i;if(t)switch(n=t.type){case"keydown":case"keyup":case"keypress":return this._getCaretPosition(e);case"click":case"mousedown":case"mouseup":return i={top:t.pageY,left:t.pageX}}},_getCaretPosition:function(e){var n,i,o;return o=t("<span/>"),n=rangy.createRange(),n.setStart(e.endContainer,e.endOffset),n.insertNode(o.get(0)),i={top:o.offset().top,left:o.offset().left},o.remove(),i},setPosition:function(){return"body"!==this.options.parentElement&&(this.options.parentElement="body",t(this.options.parentElement).append(this.toolbar)),this.toolbar.css("position","absolute"),this.toolbar.css("top",this.element.offset().top-20),this.toolbar.css("left",this.element.offset().left)},_updatePosition:function(e,n){var i,o,r,a,s;if(null==n&&(n=null),e&&e.top&&e.left)return r=this.toolbar.outerHeight()+10,n&&!n.collapsed&&n.nativeRange?(o=n.nativeRange.getBoundingClientRect(),s=this.options.positionAbove?o.top-r:o.bottom+10,a=t(window).scrollTop()+s,i=t(window).scrollLeft()+o.left):(s=this.options.positionAbove?-10-r:20,a=e.top+s,i=e.left-this.toolbar.outerWidth()/2+30),this.toolbar.css("top",a),this.toolbar.css("left",i)},_bindEvents:function(){return this.element.on("halloselected",function(t){
return function(e,n){var i;if(i=t._getPosition(n.originalEvent,n.selection))return t._updatePosition(i,n.selection),""!==t.toolbar.html()?t.toolbar.show():void 0}}(this)),this.element.on("hallounselected",function(t){return function(e,n){return t.toolbar.hide()}}(this)),this.element.on("hallodeactivated",function(t){return function(e,n){return t.toolbar.hide()}}(this))}})}(jQuery)},283:function(t,e){!function(t){return t.widget("IKS.hallobutton",{button:null,isChecked:!1,options:{uuid:"",label:null,icon:null,editable:null,command:null,commandValue:null,queryState:!0,cssClass:null},_create:function(){var t,e,n,i;return null==(t=this.options).icon&&(t.icon="icon-"+this.options.label.toLowerCase()),n=this.options.uuid+"-"+this.options.label,i=this.options,this.button=this._createButton(n,i.command,i.label,i.icon),this.element.append(this.button),this.options.cssClass&&this.button.addClass(this.options.cssClass),this.options.editable.options.touchScreen&&this.button.addClass("btn-large"),this.button.data("hallo-command",this.options.command),this.options.commandValue&&this.button.data("hallo-command-value",this.options.commandValue),e="ui-state-hover",this.button.on("mouseenter",function(t){return function(n){if(t.isEnabled())return t.button.addClass(e)}}(this)),this.button.on("mouseleave",function(t){return function(n){return t.button.removeClass(e)}}(this))},_init:function(){var t,e,n;if(this.button||(this.button=this._prepareButton()),this.element.append(this.button),n=this.options.queryState===!0?function(t){return function(e){var n,i,o,r;if(t.options.command)try{return t.options.commandValue?(r=document.queryCommandValue(t.options.command),n=r.match(new RegExp(t.options.commandValue,"i")),t.checked(!!n)):t.checked(document.queryCommandState(t.options.command))}catch(o){i=o}}}(this):this.options.queryState,this.options.command&&this.button.on("click",function(t){return function(e){return t.options.commandValue?t.options.editable.execute(t.options.command,t.options.commandValue):t.options.editable.execute(t.options.command),n(),!1}}(this)),this.options.queryState)return t=this.options.editable.element,e="keyup paste change mouseup hallomodified",t.on(e,n),t.on("halloenabled",function(i){return function(){return t.on(e,n)}}(this)),t.on("hallodisabled",function(i){return function(){return t.off(e,n)}}(this))},enable:function(){return this.button.removeAttr("disabled")},disable:function(){return this.button.attr("disabled","true")},isEnabled:function(){return"true"!==this.button.attr("disabled")},refresh:function(){return this.isChecked?this.button.addClass("ui-state-active"):this.button.removeClass("ui-state-active")},checked:function(t){return this.isChecked=t,this.refresh()},_createButton:function(e,n,i,o){var r;return r=["ui-button","ui-widget","ui-state-default","ui-corner-all","ui-button-text-only",n+"_button"],t('<button id="'+e+'" class="'+r.join(" ")+'" title="'+i+'"> <span class="ui-button-text"> <i class="'+o+'"></i> </span> </button>')}}),t.widget("IKS.hallobuttonset",{buttons:null,_create:function(){return this.element.addClass("ui-buttonset")},_init:function(){return this.refresh()},refresh:function(){var t;return t="rtl"===this.element.css("direction"),this.buttons=this.element.find(".ui-button"),this.buttons.removeClass("ui-corner-all ui-corner-left ui-corner-right"),t?(this.buttons.filter(":first").addClass("ui-corner-right"),this.buttons.filter(":last").addClass("ui-corner-left")):(this.buttons.filter(":first").addClass("ui-corner-left"),this.buttons.filter(":last").addClass("ui-corner-right"))}})}(jQuery)},284:function(t,e){!function(t){return t.widget("IKS.hallodropdownbutton",{button:null,options:{uuid:"",label:null,icon:null,editable:null,target:"",cssClass:null},_create:function(){var t;return null!=(t=this.options).icon?t.icon:t.icon="icon-"+this.options.label.toLowerCase()},_init:function(){var e;return e=t(this.options.target),e.css("position","absolute"),e.addClass("dropdown-menu"),e.hide(),this.button||(this.button=this._prepareButton()),this.button.on("click",function(t){return function(){return e.hasClass("open")?void t._hideTarget():t._showTarget()}}(this)),e.on("click",function(t){return function(){return t._hideTarget()}}(this)),this.options.editable.element.on("hallodeactivated",function(t){return function(){return t._hideTarget()}}(this)),this.element.append(this.button)},_showTarget:function(){var e;return e=t(this.options.target),this._updateTargetPosition(),e.addClass("open"),e.show()},_hideTarget:function(){var e;return e=t(this.options.target),e.removeClass("open"),e.hide()},_updateTargetPosition:function(){var e,n,i,o;return i=t(this.options.target),n=this.button.position(),o=n.top,e=n.left,o+=this.button.outerHeight(),i.css("top",o),i.css("left",e-20)},_prepareButton:function(){var e,n,i;return i=this.options.uuid+"-"+this.options.label,n=["ui-button","ui-widget","ui-state-default","ui-corner-all","ui-button-text-only"],e=t('<button id="'+i+'" class="'+n.join(" ")+'" title="'+this.options.label+'"> <span class="ui-button-text"><i class="'+this.options.icon+'"></i></span> </button>'),this.options.cssClass&&e.addClass(this.options.cssClass),e}})}(jQuery)},285:function(t,e,n){(function(e){t.exports=e.rangy=n(290)}).call(e,function(){return this}())},286:function(t,e,n){var i,o,r;!function(a){o=[n(16)],i=a,r="function"==typeof i?i.apply(e,o):i,!(void 0!==r&&(t.exports=r))}(function(t){return t.ui=t.ui||{},t.ui.version="1.12.0"})},287:function(t,e,n){var i,o,r;/*!
	 * jQuery UI Widget 1.12.0
	 * http://jqueryui.com
	 *
	 * Copyright jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 */
!function(a){o=[n(16),n(286)],i=a,r="function"==typeof i?i.apply(e,o):i,!(void 0!==r&&(t.exports=r))}(function(t){var e=0,n=Array.prototype.slice;return t.cleanData=function(e){return function(n){var i,o,r;for(r=0;null!=(o=n[r]);r++)try{i=t._data(o,"events"),i&&i.remove&&t(o).triggerHandler("remove")}catch(a){}e(n)}}(t.cleanData),t.widget=function(e,n,i){var o,r,a,s={},l=e.split(".")[0];e=e.split(".")[1];var u=l+"-"+e;return i||(i=n,n=t.Widget),t.isArray(i)&&(i=t.extend.apply(null,[{}].concat(i))),t.expr[":"][u.toLowerCase()]=function(e){return!!t.data(e,u)},t[l]=t[l]||{},o=t[l][e],r=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new r(t,e)},t.extend(r,o,{version:i.version,_proto:t.extend({},i),_childConstructors:[]}),a=new n,a.options=t.widget.extend({},a.options),t.each(i,function(e,i){return t.isFunction(i)?void(s[e]=function(){function t(){return n.prototype[e].apply(this,arguments)}function o(t){return n.prototype[e].apply(this,t)}return function(){var e,n=this._super,r=this._superApply;return this._super=t,this._superApply=o,e=i.apply(this,arguments),this._super=n,this._superApply=r,e}}()):void(s[e]=i)}),r.prototype=t.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||e:e},s,{constructor:r,namespace:l,widgetName:e,widgetFullName:u}),o?(t.each(o._childConstructors,function(e,n){var i=n.prototype;t.widget(i.namespace+"."+i.widgetName,r,n._proto)}),delete o._childConstructors):n._childConstructors.push(r),t.widget.bridge(e,r),r},t.widget.extend=function(e){for(var i,o,r=n.call(arguments,1),a=0,s=r.length;a<s;a++)for(i in r[a])o=r[a][i],r[a].hasOwnProperty(i)&&void 0!==o&&(t.isPlainObject(o)?e[i]=t.isPlainObject(e[i])?t.widget.extend({},e[i],o):t.widget.extend({},o):e[i]=o);return e},t.widget.bridge=function(e,i){var o=i.prototype.widgetFullName||e;t.fn[e]=function(r){var a="string"==typeof r,s=n.call(arguments,1),l=this;return a?this.each(function(){var n,i=t.data(this,o);return"instance"===r?(l=i,!1):i?t.isFunction(i[r])&&"_"!==r.charAt(0)?(n=i[r].apply(i,s),n!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+r+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")}):(s.length&&(r=t.widget.extend.apply(null,[r].concat(s))),this.each(function(){var e=t.data(this,o);e?(e.option(r||{}),e._init&&e._init()):t.data(this,o,new i(r,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(n,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,n){e._removeClass(n,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var i,o,r,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},i=e.split("."),e=i.shift(),i.length){for(o=a[e]=t.widget.extend({},this.options[e]),r=0;r<i.length-1;r++)o[i[r]]=o[i[r]]||{},o=o[i[r]];if(e=i.pop(),1===arguments.length)return void 0===o[e]?null:o[e];o[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var n,i,o;for(n in e)o=this.classesElementLookup[n],e[n]!==this.options.classes[n]&&o&&o.length&&(i=t(o.get()),this._removeClass(o,n),i.addClass(this._classes({element:i,keys:n,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function n(n,r){var a,s;for(s=0;s<n.length;s++)a=o.classesElementLookup[n[s]]||t(),a=t(e.add?t.unique(a.get().concat(e.element.get())):a.not(e.element).get()),o.classesElementLookup[n[s]]=a,i.push(n[s]),r&&e.classes[n[s]]&&i.push(e.classes[n[s]])}var i=[],o=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),e.keys&&n(e.keys.match(/\S+/g)||[],!0),e.extra&&n(e.extra.match(/\S+/g)||[]),i.join(" ")},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,i){i="boolean"==typeof i?i:n;var o="string"==typeof t||null===t,r={extra:o?e:n,keys:o?t:e,element:o?this.element:t,add:i};return r.element.toggleClass(this._classes(r),i),this},_on:function(e,n,i){var o,r=this;"boolean"!=typeof e&&(i=n,n=e,e=!1),i?(n=o=t(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),t.each(i,function(i,a){function s(){if(e||r.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof a?r[a]:a).apply(r,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||t.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),u=l[1]+r.eventNamespace,c=l[2];c?o.on(u,c,s):n.on(u,s)})},_off:function(e,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(n).off(n),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function n(){return("string"==typeof t?i[t]:t).apply(i,arguments)}var i=this;return setTimeout(n,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,n,i){var o,r,a=this.options[e];if(i=i||{},n=t.Event(n),n.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!(t.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(i,o,r){"string"==typeof o&&(o={effect:o});var a,s=o?o===!0||"number"==typeof o?n:o.effect||n:e;o=o||{},"number"==typeof o&&(o={duration:o}),a=!t.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),a&&t.effects&&t.effects.effect[s]?i[e](o):s!==e&&i[s]?i[s](o.duration,o.easing,r):i.queue(function(n){t(this)[e](),r&&r.call(i[0]),n()})}}),t.widget})},290:function(t,e,n){var i,o;!function(r,a){i=r,o="function"==typeof i?i.call(e,n,e,t):i,!(void 0!==o&&(t.exports=o))}(function(){function t(t,e){var n=typeof t[e];return n==y||!(n!=b||!t[e])||"unknown"==n}function e(t,e){return!(typeof t[e]!=b||!t[e])}function n(t,e){return typeof t[e]!=C}function i(t){return function(e,n){for(var i=n.length;i--;)if(!t(e,n[i]))return!1;return!0}}function o(t){return t&&S(t,F)&&T(t,E)}function r(t){return e(t,"body")?t.body:t.getElementsByTagName("body")[0]}function a(e){typeof console!=C&&t(console,"log")&&console.log(e)}function s(t,e){O&&e?alert(t):a(t)}function l(t){A.initialized=!0,A.supported=!1,s("Rangy is not supported in this environment. Reason: "+t,A.config.alertOnFail)}function u(t){s("Rangy warning: "+t,A.config.alertOnWarn)}function c(t){return t.message||t.description||String(t)}function d(){if(O&&!A.initialized){var e,n=!1,i=!1;t(document,"createRange")&&(e=document.createRange(),S(e,R)&&T(e,w)&&(n=!0));var s=r(document);if(!s||"body"!=s.nodeName.toLowerCase())return void l("No body element found");if(s&&t(s,"createTextRange")&&(e=s.createTextRange(),o(e)&&(i=!0)),!n&&!i)return void l("Neither Range nor TextRange are available");A.initialized=!0,A.features={implementsDomRange:n,implementsTextRange:i};var u,d;for(var h in D)(u=D[h])instanceof g&&u.init(u,A);for(var f=0,p=L.length;f<p;++f)try{L[f](A)}catch(m){d="Rangy init listener threw an exception. Continuing. Detail: "+c(m),a(d)}}}function h(t,e,n){n&&(t+=" in module "+n.name),A.warn("DEPRECATED: "+t+" is deprecated. Please use "+e+" instead.")}function f(t,e,n,i){t[e]=function(){return h(e,n,i),t[n].apply(t,k.toArray(arguments))}}function p(t){t=t||window,d();for(var e=0,n=M.length;e<n;++e)M[e](t)}function g(t,e,n){this.name=t,this.dependencies=e,this.initialized=!1,this.supported=!1,this.initializer=n}function m(t,e,n){var i=new g(t,e,function(e){if(!e.initialized){e.initialized=!0;try{n(A,e),e.supported=!0}catch(i){var o="Module '"+t+"' failed to load: "+c(i);a(o),i.stack&&a(i.stack)}}});return D[t]=i,i}function v(){}function _(){}var b="object",y="function",C="undefined",w=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],R=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],E=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],F=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],S=i(t),N=i(e),T=i(n),x=[].forEach?function(t,e){t.forEach(e)}:function(t,e){for(var n=0,i=t.length;n<i;++n)e(t[n],n)},D={},O=typeof window!=C&&typeof document!=C,k={isHostMethod:t,isHostObject:e,isHostProperty:n,areHostMethods:S,areHostObjects:N,areHostProperties:T,isTextRange:o,getBody:r,forEach:x},A={version:"1.3.0",initialized:!1,isBrowser:O,supported:!0,util:k,features:{},modules:D,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==C||rangyAutoInitialize}};A.fail=l,A.warn=u;var I;({}).hasOwnProperty?(k.extend=I=function(t,e,n){var i,o;for(var r in e)e.hasOwnProperty(r)&&(i=t[r],o=e[r],n&&null!==i&&"object"==typeof i&&null!==o&&"object"==typeof o&&I(i,o,!0),t[r]=o);return e.hasOwnProperty("toString")&&(t.toString=e.toString),t},k.createOptions=function(t,e){var n={};return I(n,e),t&&I(n,t),n}):l("hasOwnProperty not supported"),O||l("Rangy can only run in a browser"),function(){var t;if(O){var e=document.createElement("div");e.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(t){return n.call(t,0)})}catch(i){}}t||(t=function(t){for(var e=[],n=0,i=t.length;n<i;++n)e[n]=t[n];return e}),k.toArray=t}();var P;O&&(t(document,"addEventListener")?P=function(t,e,n){t.addEventListener(e,n,!1)}:t(document,"attachEvent")?P=function(t,e,n){t.attachEvent("on"+e,n)}:l("Document does not have required addEventListener or attachEvent method"),k.addListener=P);var L=[];k.deprecationNotice=h,k.createAliasForDeprecatedMethod=f,A.init=d,A.addInitListener=function(t){A.initialized?t(A):L.push(t)};var M=[];A.addShimListener=function(t){M.push(t)},O&&(A.shim=A.createMissingNativeApi=p,f(A,"createMissingNativeApi","shim")),g.prototype={init:function(){for(var t,e,n=this.dependencies||[],i=0,o=n.length;i<o;++i){if(e=n[i],t=D[e],!(t&&t instanceof g))throw new Error("required module '"+e+"' not found");if(t.init(),!t.supported)throw new Error("required module '"+e+"' not supported")}this.initializer(this)},fail:function(t){throw this.initialized=!0,this.supported=!1,new Error(t)},warn:function(t){A.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,e){A.warn("DEPRECATED: "+t+" in module "+this.name+" is deprecated. Please use "+e+" instead")},createError:function(t){return new Error("Error in Rangy "+this.name+" module: "+t)}},A.createModule=function(t){var e,n;2==arguments.length?(e=arguments[1],n=[]):(e=arguments[2],n=arguments[1]);var i=m(t,n,e);A.initialized&&A.supported&&i.init()},A.createCoreModule=function(t,e,n){m(t,e,n)},A.RangePrototype=v,A.rangePrototype=new v,A.selectionPrototype=new _,A.createCoreModule("DomUtil",[],function(t,e){function n(t){var e;return typeof t.namespaceURI==O||null===(e=t.namespaceURI)||"http://www.w3.org/1999/xhtml"==e}function i(t){var e=t.parentNode;return 1==e.nodeType?e:null}function o(t){for(var e=0;t=t.previousSibling;)++e;return e}function r(t){switch(t.nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}}function a(t,e){var n,i=[];for(n=t;n;n=n.parentNode)i.push(n);for(n=e;n;n=n.parentNode)if(L(i,n))return n;return null}function s(t,e,n){for(var i=n?e:e.parentNode;i;){if(i===t)return!0;i=i.parentNode}return!1}function l(t,e){return s(t,e,!0)}function u(t,e,n){for(var i,o=n?t:t.parentNode;o;){if(i=o.parentNode,i===e)return o;o=i}return null}function c(t){var e=t.nodeType;return 3==e||4==e||8==e}function d(t){if(!t)return!1;var e=t.nodeType;return 3==e||8==e}function h(t,e){var n=e.nextSibling,i=e.parentNode;return n?i.insertBefore(t,n):i.appendChild(t),t}function f(t,e,n){var i=t.cloneNode(!1);if(i.deleteData(0,e),t.deleteData(e,t.length-e),h(i,t),n)for(var r,a=0;r=n[a++];)r.node==t&&r.offset>e?(r.node=i,r.offset-=e):r.node==t.parentNode&&r.offset>o(t)&&++r.offset;return i}function p(t){if(9==t.nodeType)return t;if(typeof t.ownerDocument!=O)return t.ownerDocument;if(typeof t.document!=O)return t.document;if(t.parentNode)return p(t.parentNode);throw e.createError("getDocument: no document found for node")}function g(t){var n=p(t);if(typeof n.defaultView!=O)return n.defaultView;if(typeof n.parentWindow!=O)return n.parentWindow;throw e.createError("Cannot get a window object for node")}function m(t){if(typeof t.contentDocument!=O)return t.contentDocument;if(typeof t.contentWindow!=O)return t.contentWindow.document;throw e.createError("getIframeDocument: No Document object found for iframe element")}function v(t){if(typeof t.contentWindow!=O)return t.contentWindow;if(typeof t.contentDocument!=O)return t.contentDocument.defaultView;throw e.createError("getIframeWindow: No Window object found for iframe element")}function _(t){return t&&k.isHostMethod(t,"setTimeout")&&k.isHostObject(t,"document")}function b(t,e,n){var i;if(t?k.isHostProperty(t,"nodeType")?i=1==t.nodeType&&"iframe"==t.tagName.toLowerCase()?m(t):p(t):_(t)&&(i=t.document):i=document,!i)throw e.createError(n+"(): Parameter must be a Window object or DOM node");return i}function y(t){for(var e;e=t.parentNode;)t=e;return t}function C(t,n,i,r){var s,l,c,d,h;if(t==i)return n===r?0:n<r?-1:1;if(s=u(i,t,!0))return n<=o(s)?-1:1;if(s=u(t,i,!0))return o(s)<r?-1:1;if(l=a(t,i),!l)throw new Error("comparePoints error: nodes have no common ancestor");if(c=t===l?l:u(t,l,!0),d=i===l?l:u(i,l,!0),c===d)throw e.createError("comparePoints got to case 4 and childA and childB are the same!");for(h=l.firstChild;h;){if(h===c)return-1;if(h===d)return 1;h=h.nextSibling}}function w(t){var e;try{return e=t.parentNode,!1}catch(n){return!0}}function R(t){if(!t)return"[No node]";if(M&&w(t))return"[Broken node]";if(c(t))return'"'+t.data+'"';if(1==t.nodeType){var e=t.id?' id="'+t.id+'"':"";return"<"+t.nodeName+e+">[index:"+o(t)+",length:"+t.childNodes.length+"]["+(t.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return t.nodeName}function E(t){for(var e,n=p(t).createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n}function F(t,e,n){var i=A(t),o=t.createElement("div");o.contentEditable=""+!!n,e&&(o.innerHTML=e);var r=i.firstChild;return r?i.insertBefore(o,r):i.appendChild(o),o}function S(t){return t.parentNode.removeChild(t)}function N(t){this.root=t,this._next=t}function T(t){return new N(t)}function x(t,e){this.node=t,this.offset=e}function D(t){this.code=this[t],this.codeName=t,this.message="DOMException: "+this.codeName}var O="undefined",k=t.util,A=k.getBody;k.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||e.fail("document missing a Node creation method"),k.isHostMethod(document,"getElementsByTagName")||e.fail("document missing getElementsByTagName method");var I=document.createElement("div");k.areHostMethods(I,["insertBefore","appendChild","cloneNode"]||!k.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"]))||e.fail("Incomplete Element implementation"),k.isHostProperty(I,"innerHTML")||e.fail("Element is missing innerHTML property");var P=document.createTextNode("test");k.areHostMethods(P,["splitText","deleteData","insertData","appendData","cloneNode"]||!k.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"])||!k.areHostProperties(P,["data"]))||e.fail("Incomplete Text Node implementation");var L=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1},M=!1;!function(){var e=document.createElement("b");e.innerHTML="1";var n=e.firstChild;e.innerHTML="<br />",M=w(n),t.features.crashyTextNodes=M}();var $;typeof window.getComputedStyle!=O?$=function(t,e){return g(t).getComputedStyle(t,null)[e]}:typeof document.documentElement.currentStyle!=O?$=function(t,e){return t.currentStyle?t.currentStyle[e]:""}:e.fail("No means of obtaining computed style properties found"),N.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var t,e,n=this._current=this._next;if(this._current)if(t=n.firstChild)this._next=t;else{for(e=null;n!==this.root&&!(e=n.nextSibling);)n=n.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}},x.prototype={equals:function(t){return!!t&&this.node===t.node&&this.offset==t.offset},inspect:function(){return"[DomPosition("+R(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},D.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},D.prototype.toString=function(){return this.message},t.dom={arrayContains:L,isHtmlNamespace:n,parentElement:i,getNodeIndex:o,getNodeLength:r,getCommonAncestor:a,isAncestorOf:s,isOrIsAncestorOf:l,getClosestAncestorIn:u,isCharacterDataNode:c,isTextOrCommentNode:d,insertAfter:h,splitDataNode:f,getDocument:p,getWindow:g,getIframeWindow:v,getIframeDocument:m,getBody:A,isWindow:_,getContentDocument:b,getRootContainer:y,comparePoints:C,isBrokenNode:w,inspectNode:R,getComputedStyleProperty:$,createTestElement:F,removeNode:S,fragmentFromNodeChildren:E,createIterator:T,DomPosition:x},t.DOMException=D}),A.createCoreModule("DomRange",["DomUtil"],function(t,e){function n(t,e){return 3!=t.nodeType&&(W(t,e.startContainer)||W(t,e.endContainer))}function i(t){return t.document||V(t.startContainer)}function o(t){return K(t.startContainer)}function r(t){return new M(t.parentNode,H(t))}function a(t){return new M(t.parentNode,H(t)+1)}function s(t,e,n){var i=11==t.nodeType?t.firstChild:t;return B(e)?n==e.length?P.insertAfter(t,e):e.parentNode.insertBefore(t,0==n?e:j(e,n)):n>=e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[n]),i}function l(t,e,n){if(F(t),F(e),i(e)!=i(t))throw new $("WRONG_DOCUMENT_ERR");var o=U(t.startContainer,t.startOffset,e.endContainer,e.endOffset),r=U(t.endContainer,t.endOffset,e.startContainer,e.startOffset);return n?o<=0&&r>=0:o<0&&r>0}function u(t){for(var e,n,o,r=i(t.range).createDocumentFragment();n=t.next();){if(e=t.isPartiallySelectedSubtree(),n=n.cloneNode(!e),e&&(o=t.getSubtreeIterator(),n.appendChild(u(o)),o.detach()),10==n.nodeType)throw new $("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function c(t,e,n){var i,o;n=n||{stop:!1};for(var r,a;r=t.next();)if(t.isPartiallySelectedSubtree()){if(e(r)===!1)return void(n.stop=!0);if(a=t.getSubtreeIterator(),c(a,e,n),a.detach(),n.stop)return}else for(i=P.createIterator(r);o=i.next();)if(e(o)===!1)return void(n.stop=!0)}function d(t){for(var e;t.next();)t.isPartiallySelectedSubtree()?(e=t.getSubtreeIterator(),d(e),e.detach()):t.remove()}function h(t){for(var e,n,o=i(t.range).createDocumentFragment();e=t.next();){if(t.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),n=t.getSubtreeIterator(),e.appendChild(h(n)),n.detach()):t.remove(),10==e.nodeType)throw new $("HIERARCHY_REQUEST_ERR");o.appendChild(e)}return o}function f(t,e,n){var i,o=!(!e||!e.length),r=!!n;o&&(i=new RegExp("^("+e.join("|")+")$"));var a=[];return c(new g(t,(!1)),function(e){if((!o||i.test(e.nodeType))&&(!r||n(e))){var s=t.startContainer;if(e!=s||!B(s)||t.startOffset!=s.length){var l=t.endContainer;e==l&&B(l)&&0==t.endOffset||a.push(e)}}}),a}function p(t){var e="undefined"==typeof t.getName?"Range":t.getName();return"["+e+"("+P.inspectNode(t.startContainer)+":"+t.startOffset+", "+P.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function g(t,e){if(this.range=t,this.clonePartiallySelectedTextNodes=e,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var n=t.commonAncestorContainer;this.sc===this.ec&&B(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||B(this.sc)?z(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||B(this.ec)?z(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function m(t){return function(e,n){for(var i,o=n?e:e.parentNode;o;){if(i=o.nodeType,Q(t,i))return o;o=o.parentNode}return null}}function v(t,e){if(ot(t,e))throw new $("INVALID_NODE_TYPE_ERR")}function _(t,e){if(!Q(e,t.nodeType))throw new $("INVALID_NODE_TYPE_ERR")}function b(t,e){if(e<0||e>(B(t)?t.length:t.childNodes.length))throw new $("INDEX_SIZE_ERR")}function y(t,e){if(nt(t,!0)!==nt(e,!0))throw new $("WRONG_DOCUMENT_ERR")}function C(t){if(it(t,!0))throw new $("NO_MODIFICATION_ALLOWED_ERR")}function w(t,e){if(!t)throw new $(e)}function R(t,e){return e<=(B(t)?t.length:t.childNodes.length)}function E(t){return!!t.startContainer&&!!t.endContainer&&!(G&&(P.isBrokenNode(t.startContainer)||P.isBrokenNode(t.endContainer)))&&K(t.startContainer)==K(t.endContainer)&&R(t.startContainer,t.startOffset)&&R(t.endContainer,t.endOffset)}function F(t){if(!E(t))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+t.inspect()+")")}function S(t,e){F(t);var n=t.startContainer,i=t.startOffset,o=t.endContainer,r=t.endOffset,a=n===o;B(o)&&r>0&&r<o.length&&j(o,r,e),B(n)&&i>0&&i<n.length&&(n=j(n,i,e),a?(r-=i,o=n):o==n.parentNode&&r>=H(n)&&r++,i=0),t.setStartAndEnd(n,i,o,r)}function N(t){F(t);var e=t.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(t.cloneContents()),e.innerHTML}function T(t){t.START_TO_START=ct,t.START_TO_END=dt,t.END_TO_END=ht,t.END_TO_START=ft,t.NODE_BEFORE=pt,t.NODE_AFTER=gt,t.NODE_BEFORE_AND_AFTER=mt,t.NODE_INSIDE=vt}function x(t){T(t),T(t.prototype)}function D(t,e){return function(){F(this);var n,i,o=this.startContainer,r=this.startOffset,s=this.commonAncestorContainer,l=new g(this,(!0));o!==s&&(n=z(o,s,!0),i=a(n),o=i.node,r=i.offset),c(l,C),l.reset();var u=t(l);return l.detach(),e(this,o,r,o,r),u}}function O(e,i){function o(t,e){return function(n){_(n,X),_(K(n),Z);var i=(t?r:a)(n);(e?s:l)(this,i.node,i.offset)}}function s(t,e,n){var o=t.endContainer,r=t.endOffset;e===t.startContainer&&n===t.startOffset||(K(e)==K(o)&&1!=U(e,n,o,r)||(o=e,r=n),i(t,e,n,o,r))}function l(t,e,n){var o=t.startContainer,r=t.startOffset;e===t.endContainer&&n===t.endOffset||(K(e)==K(o)&&U(e,n,o,r)!=-1||(o=e,r=n),i(t,o,r,e,n))}var u=function(){};u.prototype=t.rangePrototype,e.prototype=new u,L.extend(e.prototype,{setStart:function(t,e){v(t,!0),b(t,e),s(this,t,e)},setEnd:function(t,e){v(t,!0),b(t,e),l(this,t,e)},setStartAndEnd:function(){var t=arguments,e=t[0],n=t[1],o=e,r=n;switch(t.length){case 3:r=t[2];break;case 4:o=t[2],r=t[3]}i(this,e,n,o,r)},setBoundary:function(t,e,n){this["set"+(n?"Start":"End")](t,e)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(t){F(this),t?i(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):i(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(t){v(t,!0),i(this,t,0,t,q(t))},selectNode:function(t){v(t,!1),_(t,X);var e=r(t),n=a(t);i(this,e.node,e.offset,n.node,n.offset)},extractContents:D(h,i),deleteContents:D(d,i),canSurroundContents:function(){F(this),C(this.startContainer),C(this.endContainer);var t=new g(this,(!0)),e=t._first&&n(t._first,this)||t._last&&n(t._last,this);return t.detach(),!e},splitBoundaries:function(){S(this)},splitBoundariesPreservingPositions:function(t){S(this,t)},normalizeBoundaries:function(){F(this);var t,e=this.startContainer,n=this.startOffset,o=this.endContainer,r=this.endOffset,a=function(t){var e=t.nextSibling;e&&e.nodeType==t.nodeType&&(o=t,r=t.length,t.appendData(e.data),Y(e))},s=function(t){var i=t.previousSibling;if(i&&i.nodeType==t.nodeType){e=t;var a=t.length;if(n=i.length,t.insertData(0,i.data),Y(i),e==o)r+=n,o=e;else if(o==t.parentNode){var s=H(t);r==s?(o=t,r=a):r>s&&r--}}},l=!0;if(B(o))r==o.length?a(o):0==r&&(t=o.previousSibling,t&&t.nodeType==o.nodeType&&(r=t.length,e==o&&(l=!1),t.appendData(o.data),Y(o),o=t));else{if(r>0){var u=o.childNodes[r-1];u&&B(u)&&a(u)}l=!this.collapsed}if(l){if(B(e))0==n?s(e):n==e.length&&(t=e.nextSibling,t&&t.nodeType==e.nodeType&&(o==t&&(o=e,r+=e.length),e.appendData(t.data),Y(t)));else if(n<e.childNodes.length){var c=e.childNodes[n];c&&B(c)&&s(c)}}else e=o,n=r;i(this,e,n,o,r)},collapseToPoint:function(t,e){v(t,!0),b(t,e),this.setStartAndEnd(t,e)}}),x(e)}function k(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:P.getCommonAncestor(t.startContainer,t.endContainer)}function A(t,e,n,i,o){t.startContainer=e,t.startOffset=n,t.endContainer=i,t.endOffset=o,t.document=P.getDocument(e),k(t)}function I(t){this.startContainer=t,this.startOffset=0,this.endContainer=t,this.endOffset=0,this.document=t,k(this)}var P=t.dom,L=t.util,M=P.DomPosition,$=t.DOMException,B=P.isCharacterDataNode,H=P.getNodeIndex,W=P.isOrIsAncestorOf,V=P.getDocument,U=P.comparePoints,j=P.splitDataNode,z=P.getClosestAncestorIn,q=P.getNodeLength,Q=P.arrayContains,K=P.getRootContainer,G=t.features.crashyTextNodes,Y=P.removeNode;g.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,B(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t,e,n=this._current;!B(n)||n!==this.sc&&n!==this.ec?n.parentNode&&Y(n):(t=n===this.sc?this.so:0,e=n===this.ec?this.eo:n.length,t!=e&&n.deleteData(t,e-t))},isPartiallySelectedSubtree:function(){var t=this._current;return n(t,this.range)},getSubtreeIterator:function(){var t;if(this.isSingleCharacterDataNode)t=this.range.cloneRange(),t.collapse(!1);else{t=new I(i(this.range));var e=this._current,n=e,o=0,r=e,a=q(e);W(e,this.sc)&&(n=this.sc,o=this.so),W(e,this.ec)&&(r=this.ec,a=this.eo),A(t,n,o,r,a)}return new g(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var X=[1,3,4,5,7,8,10],Z=[2,9,11],J=[5,6,10,12],tt=[1,3,4,5,7,8,10,11],et=[1,3,4,5,7,8],nt=m([9,11]),it=m(J),ot=m([6,10,12]),rt=document.createElement("style"),at=!1;try{rt.innerHTML="<b>x</b>",at=3==rt.firstChild.nodeType}catch(st){}t.features.htmlParsingConforms=at;var lt=at?function(t){var e=this.startContainer,n=V(e);if(!e)throw new $("INVALID_STATE_ERR");var i=null;return 1==e.nodeType?i=e:B(e)&&(i=P.parentElement(e)),i=null===i||"HTML"==i.nodeName&&P.isHtmlNamespace(V(i).documentElement)&&P.isHtmlNamespace(i)?n.createElement("body"):i.cloneNode(!1),i.innerHTML=t,P.fragmentFromNodeChildren(i)}:function(t){var e=i(this),n=e.createElement("body");return n.innerHTML=t,P.fragmentFromNodeChildren(n)},ut=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ct=0,dt=1,ht=2,ft=3,pt=0,gt=1,mt=2,vt=3;L.extend(t.rangePrototype,{compareBoundaryPoints:function(t,e){F(this),y(this.startContainer,e.startContainer);var n,i,o,r,a=t==ft||t==ct?"start":"end",s=t==dt||t==ct?"start":"end";return n=this[a+"Container"],i=this[a+"Offset"],o=e[s+"Container"],r=e[s+"Offset"],U(n,i,o,r)},insertNode:function(t){if(F(this),_(t,tt),C(this.startContainer),W(t,this.startContainer))throw new $("HIERARCHY_REQUEST_ERR");var e=s(t,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){F(this);var t,e;if(this.collapsed)return i(this).createDocumentFragment();if(this.startContainer===this.endContainer&&B(this.startContainer))return t=this.startContainer.cloneNode(!0),t.data=t.data.slice(this.startOffset,this.endOffset),e=i(this).createDocumentFragment(),e.appendChild(t),e;var n=new g(this,(!0));return t=u(n),n.detach(),t},canSurroundContents:function(){F(this),C(this.startContainer),C(this.endContainer);var t=new g(this,(!0)),e=t._first&&n(t._first,this)||t._last&&n(t._last,this);return t.detach(),!e},surroundContents:function(t){if(_(t,et),!this.canSurroundContents())throw new $("INVALID_STATE_ERR");var e=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);s(t,this.startContainer,this.startOffset),t.appendChild(e),this.selectNode(t)},cloneRange:function(){F(this);for(var t,e=new I(i(this)),n=ut.length;n--;)t=ut[n],e[t]=this[t];return e},toString:function(){F(this);var t=this.startContainer;if(t===this.endContainer&&B(t))return 3==t.nodeType||4==t.nodeType?t.data.slice(this.startOffset,this.endOffset):"";var e=[],n=new g(this,(!0));return c(n,function(t){3!=t.nodeType&&4!=t.nodeType||e.push(t.data)}),n.detach(),e.join("")},compareNode:function(t){F(this);var e=t.parentNode,n=H(t);if(!e)throw new $("NOT_FOUND_ERR");var i=this.comparePoint(e,n),o=this.comparePoint(e,n+1);return i<0?o>0?mt:pt:o>0?gt:vt},comparePoint:function(t,e){return F(this),w(t,"HIERARCHY_REQUEST_ERR"),y(t,this.startContainer),U(t,e,this.startContainer,this.startOffset)<0?-1:U(t,e,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:lt,toHtml:function(){return N(this)},intersectsNode:function(t,e){if(F(this),K(t)!=o(this))return!1;var n=t.parentNode,i=H(t);if(!n)return!0;var r=U(n,i,this.endContainer,this.endOffset),a=U(n,i+1,this.startContainer,this.startOffset);return e?r<=0&&a>=0:r<0&&a>0},isPointInRange:function(t,e){return F(this),w(t,"HIERARCHY_REQUEST_ERR"),y(t,this.startContainer),U(t,e,this.startContainer,this.startOffset)>=0&&U(t,e,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){
return l(this,t,!1)},intersectsOrTouchesRange:function(t){return l(this,t,!0)},intersection:function(t){if(this.intersectsRange(t)){var e=U(this.startContainer,this.startOffset,t.startContainer,t.startOffset),n=U(this.endContainer,this.endOffset,t.endContainer,t.endOffset),i=this.cloneRange();return e==-1&&i.setStart(t.startContainer,t.startOffset),1==n&&i.setEnd(t.endContainer,t.endOffset),i}return null},union:function(t){if(this.intersectsOrTouchesRange(t)){var e=this.cloneRange();return U(t.startContainer,t.startOffset,this.startContainer,this.startOffset)==-1&&e.setStart(t.startContainer,t.startOffset),1==U(t.endContainer,t.endOffset,this.endContainer,this.endOffset)&&e.setEnd(t.endContainer,t.endOffset),e}throw new $("Ranges do not intersect")},containsNode:function(t,e){return e?this.intersectsNode(t,!1):this.compareNode(t)==vt},containsNodeContents:function(t){return this.comparePoint(t,0)>=0&&this.comparePoint(t,q(t))<=0},containsRange:function(t){var e=this.intersection(t);return null!==e&&t.equals(e)},containsNodeText:function(t){var e=this.cloneRange();e.selectNode(t);var n=e.getNodes([3]);if(n.length>0){e.setStart(n[0],0);var i=n.pop();return e.setEnd(i,i.length),this.containsRange(e)}return this.containsNodeContents(t)},getNodes:function(t,e){return F(this),f(this,t,e)},getDocument:function(){return i(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(e){var n=i(this),o=t.createRange(n);e=e||P.getBody(n),o.selectNodeContents(e);var r=this.intersection(o),a=0,s=0;return r&&(o.setEnd(r.startContainer,r.startOffset),a=o.toString().length,s=a+r.toString().length),{start:a,end:s,containerNode:e}},moveToBookmark:function(t){var e=t.containerNode,n=0;this.setStart(e,0),this.collapse(!0);for(var i,o,r,a,s=[e],l=!1,u=!1;!u&&(i=s.pop());)if(3==i.nodeType)o=n+i.length,!l&&t.start>=n&&t.start<=o&&(this.setStart(i,t.start-n),l=!0),l&&t.end>=n&&t.end<=o&&(this.setEnd(i,t.end-n),u=!0),n=o;else for(a=i.childNodes,r=a.length;r--;)s.push(a[r])},getName:function(){return"DomRange"},equals:function(t){return I.rangesEqual(this,t)},isValid:function(){return E(this)},inspect:function(){return p(this)},detach:function(){}}),O(I,A),L.extend(I,{rangeProperties:ut,RangeIterator:g,copyComparisonConstants:x,createPrototypeRange:O,inspect:p,toHtml:N,getRangeDocument:i,rangesEqual:function(t,e){return t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}),t.DomRange=I}),A.createCoreModule("WrappedRange",["DomRange"],function(t,e){var n,i,o=t.dom,r=t.util,a=o.DomPosition,s=t.DomRange,l=o.getBody,u=o.getContentDocument,c=o.isCharacterDataNode;if(t.features.implementsDomRange&&!function(){function i(t){for(var e,n=h.length;n--;)e=h[n],t[e]=t.nativeRange[e];t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset}function a(t,e,n,i,o){var r=t.startContainer!==e||t.startOffset!=n,a=t.endContainer!==i||t.endOffset!=o,s=!t.equals(t.nativeRange);(r||a||s)&&(t.setEnd(i,o),t.setStart(e,n))}var c,d,h=s.rangeProperties;n=function(t){if(!t)throw e.createError("WrappedRange: Range must be specified");this.nativeRange=t,i(this)},s.createPrototypeRange(n,a),c=n.prototype,c.selectNode=function(t){this.nativeRange.selectNode(t),i(this)},c.cloneContents=function(){return this.nativeRange.cloneContents()},c.surroundContents=function(t){this.nativeRange.surroundContents(t),i(this)},c.collapse=function(t){this.nativeRange.collapse(t),i(this)},c.cloneRange=function(){return new n(this.nativeRange.cloneRange())},c.refresh=function(){i(this)},c.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");l(document).appendChild(f);var p=document.createRange();p.setStart(f,0),p.setEnd(f,0);try{p.setStart(f,1),c.setStart=function(t,e){this.nativeRange.setStart(t,e),i(this)},c.setEnd=function(t,e){this.nativeRange.setEnd(t,e),i(this)},d=function(t){return function(e){this.nativeRange[t](e),i(this)}}}catch(g){c.setStart=function(t,e){try{this.nativeRange.setStart(t,e)}catch(n){this.nativeRange.setEnd(t,e),this.nativeRange.setStart(t,e)}i(this)},c.setEnd=function(t,e){try{this.nativeRange.setEnd(t,e)}catch(n){this.nativeRange.setStart(t,e),this.nativeRange.setEnd(t,e)}i(this)},d=function(t,e){return function(n){try{this.nativeRange[t](n)}catch(o){this.nativeRange[e](n),this.nativeRange[t](n)}i(this)}}}c.setStartBefore=d("setStartBefore","setEndBefore"),c.setStartAfter=d("setStartAfter","setEndAfter"),c.setEndBefore=d("setEndBefore","setStartBefore"),c.setEndAfter=d("setEndAfter","setStartAfter"),c.selectNodeContents=function(t){this.setStartAndEnd(t,0,o.getNodeLength(t))},p.selectNodeContents(f),p.setEnd(f,3);var m=document.createRange();m.selectNodeContents(f),m.setEnd(f,4),m.setStart(f,2),p.compareBoundaryPoints(p.START_TO_END,m)==-1&&1==p.compareBoundaryPoints(p.END_TO_START,m)?c.compareBoundaryPoints=function(t,e){return e=e.nativeRange||e,t==e.START_TO_END?t=e.END_TO_START:t==e.END_TO_START&&(t=e.START_TO_END),this.nativeRange.compareBoundaryPoints(t,e)}:c.compareBoundaryPoints=function(t,e){return this.nativeRange.compareBoundaryPoints(t,e.nativeRange||e)};var v=document.createElement("div");v.innerHTML="123";var _=v.firstChild,b=l(document);b.appendChild(v),p.setStart(_,1),p.setEnd(_,2),p.deleteContents(),"13"==_.data&&(c.deleteContents=function(){this.nativeRange.deleteContents(),i(this)},c.extractContents=function(){var t=this.nativeRange.extractContents();return i(this),t}),b.removeChild(v),b=null,r.isHostMethod(p,"createContextualFragment")&&(c.createContextualFragment=function(t){return this.nativeRange.createContextualFragment(t)}),l(document).removeChild(f),c.getName=function(){return"WrappedRange"},t.WrappedRange=n,t.createNativeRange=function(t){return t=u(t,e,"createNativeRange"),t.createRange()}}(),t.features.implementsTextRange){var d=function(t){var e=t.parentElement(),n=t.duplicate();n.collapse(!0);var i=n.parentElement();n=t.duplicate(),n.collapse(!1);var r=n.parentElement(),a=i==r?i:o.getCommonAncestor(i,r);return a==e?a:o.getCommonAncestor(e,a)},h=function(t){return 0==t.compareEndPoints("StartToEnd",t)},f=function(t,e,n,i,r){var s=t.duplicate();s.collapse(n);var l=s.parentElement();if(o.isOrIsAncestorOf(e,l)||(l=e),!l.canHaveHTML){var u=new a(l.parentNode,o.getNodeIndex(l));return{boundaryPosition:u,nodeInfo:{nodeIndex:u.offset,containerElement:u.node}}}var d=o.getDocument(l).createElement("span");d.parentNode&&o.removeNode(d);for(var h,f,p,g,m,v=n?"StartToStart":"StartToEnd",_=r&&r.containerElement==l?r.nodeIndex:0,b=l.childNodes.length,y=b,C=y;;){if(C==b?l.appendChild(d):l.insertBefore(d,l.childNodes[C]),s.moveToElementText(d),h=s.compareEndPoints(v,t),0==h||_==y)break;if(h==-1){if(y==_+1)break;_=C}else y=y==_+1?_:C;C=Math.floor((_+y)/2),l.removeChild(d)}if(m=d.nextSibling,h==-1&&m&&c(m)){s.setEndPoint(n?"EndToStart":"EndToEnd",t);var w;if(/[\r\n]/.test(m.data)){var R=s.duplicate(),E=R.text.replace(/\r\n/g,"\r").length;for(w=R.moveStart("character",E);(h=R.compareEndPoints("StartToEnd",R))==-1;)w++,R.moveStart("character",1)}else w=s.text.length;g=new a(m,w)}else f=(i||!n)&&d.previousSibling,p=(i||n)&&d.nextSibling,g=p&&c(p)?new a(p,0):f&&c(f)?new a(f,f.data.length):new a(l,o.getNodeIndex(d));return o.removeNode(d),{boundaryPosition:g,nodeInfo:{nodeIndex:C,containerElement:l}}},p=function(t,e){var n,i,r,a,s=t.offset,u=o.getDocument(t.node),d=l(u).createTextRange(),h=c(t.node);return h?(n=t.node,i=n.parentNode):(a=t.node.childNodes,n=s<a.length?a[s]:null,i=t.node),r=u.createElement("span"),r.innerHTML="&#feff;",n?i.insertBefore(r,n):i.appendChild(r),d.moveToElementText(r),d.collapse(!e),i.removeChild(r),h&&d[e?"moveStart":"moveEnd"]("character",s),d};i=function(t){this.textRange=t,this.refresh()},i.prototype=new s(document),i.prototype.refresh=function(){var t,e,n,i=d(this.textRange);h(this.textRange)?e=t=f(this.textRange,i,!0,!0).boundaryPosition:(n=f(this.textRange,i,!0,!1),t=n.boundaryPosition,e=f(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(t.node,t.offset),this.setEnd(e.node,e.offset)},i.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(i);var g=function(t){if(t.collapsed)return p(new a(t.startContainer,t.startOffset),!0);var e=p(new a(t.startContainer,t.startOffset),!0),n=p(new a(t.endContainer,t.endOffset),!1),i=l(s.getRangeDocument(t)).createTextRange();return i.setEndPoint("StartToStart",e),i.setEndPoint("EndToEnd",n),i};if(i.rangeToTextRange=g,i.prototype.toTextRange=function(){return g(this)},t.WrappedTextRange=i,!t.features.implementsDomRange||t.config.preferTextRange){var m=function(t){return t("return this;")()}(Function);"undefined"==typeof m.Range&&(m.Range=i),t.createNativeRange=function(t){return t=u(t,e,"createNativeRange"),l(t).createTextRange()},t.WrappedRange=i}}t.createRange=function(n){return n=u(n,e,"createRange"),new t.WrappedRange(t.createNativeRange(n))},t.createRangyRange=function(t){return t=u(t,e,"createRangyRange"),new s(t)},r.createAliasForDeprecatedMethod(t,"createIframeRange","createRange"),r.createAliasForDeprecatedMethod(t,"createIframeRangyRange","createRangyRange"),t.addShimListener(function(e){var n=e.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return t.createRange(n)}),n=e=null})}),A.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(t,e){function n(t){return"string"==typeof t?/^backward(s)?$/i.test(t):!!t}function i(t,n){if(t){if(T.isWindow(t))return t;if(t instanceof v)return t.win;var i=T.getContentDocument(t,e,n);return T.getWindow(i)}return window}function o(t){return i(t,"getWinSelection").getSelection()}function r(t){return i(t,"getDocSelection").document.selection}function a(t){var e=!1;return t.anchorNode&&(e=1==T.comparePoints(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)),e}function s(t,e,n){var i=n?"end":"start",o=n?"start":"end";t.anchorNode=e[i+"Container"],t.anchorOffset=e[i+"Offset"],t.focusNode=e[o+"Container"],t.focusOffset=e[o+"Offset"]}function l(t){var e=t.nativeSelection;t.anchorNode=e.anchorNode,t.anchorOffset=e.anchorOffset,t.focusNode=e.focusNode,t.focusOffset=e.focusOffset}function u(t){t.anchorNode=t.focusNode=null,t.anchorOffset=t.focusOffset=0,t.rangeCount=0,t.isCollapsed=!0,t._ranges.length=0}function c(e){var n;return e instanceof O?(n=t.createNativeRange(e.getDocument()),n.setEnd(e.endContainer,e.endOffset),n.setStart(e.startContainer,e.startOffset)):e instanceof k?n=e.nativeRange:P.implementsDomRange&&e instanceof T.getWindow(e.startContainer).Range&&(n=e),n}function d(t){if(!t.length||1!=t[0].nodeType)return!1;for(var e=1,n=t.length;e<n;++e)if(!T.isAncestorOf(t[0],t[e]))return!1;return!0}function h(t){var n=t.getNodes();if(!d(n))throw e.createError("getSingleElementFromRange: range "+t.inspect()+" did not consist of a single element");return n[0]}function f(t){return!!t&&"undefined"!=typeof t.text}function p(t,e){var n=new k(e);t._ranges=[n],s(t,n,!1),t.rangeCount=1,t.isCollapsed=n.collapsed}function g(e){if(e._ranges.length=0,"None"==e.docSelection.type)u(e);else{var n=e.docSelection.createRange();if(f(n))p(e,n);else{e.rangeCount=n.length;for(var i,o=M(n.item(0)),r=0;r<e.rangeCount;++r)i=t.createRange(o),i.selectNode(n.item(r)),e._ranges.push(i);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,s(e,e._ranges[e.rangeCount-1],!1)}}}function m(t,n){for(var i=t.docSelection.createRange(),o=h(n),r=M(i.item(0)),a=$(r).createControlRange(),s=0,l=i.length;s<l;++s)a.add(i.item(s));try{a.add(o)}catch(u){throw e.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),g(t)}function v(t,e,n){this.nativeSelection=t,this.docSelection=e,this._ranges=[],this.win=n,this.refresh()}function _(t){t.win=t.anchorNode=t.focusNode=t._ranges=null,t.rangeCount=t.anchorOffset=t.focusOffset=0,t.detached=!0}function b(t,e){for(var n,i,o=et.length;o--;)if(n=et[o],i=n.selection,"deleteAll"==e)_(i);else if(n.win==t)return"delete"==e?(et.splice(o,1),!0):i;return"deleteAll"==e&&(et.length=0),null}function y(t,n){for(var i,o=M(n[0].startContainer),r=$(o).createControlRange(),a=0,s=n.length;a<s;++a){i=h(n[a]);try{r.add(i)}catch(l){throw e.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),g(t)}function C(t,e){if(t.win.document!=M(e))throw new A("WRONG_DOCUMENT_ERR")}function w(e){return function(n,i){var o;this.rangeCount?(o=this.getRangeAt(0),o["set"+(e?"Start":"End")](n,i)):(o=t.createRange(this.win.document),o.setStartAndEnd(n,i)),this.setSingleRange(o,this.isBackward())}}function R(t){var e=[],n=new I(t.anchorNode,t.anchorOffset),i=new I(t.focusNode,t.focusOffset),o="function"==typeof t.getName?t.getName():"Selection";if("undefined"!=typeof t.rangeCount)for(var r=0,a=t.rangeCount;r<a;++r)e[r]=O.inspect(t.getRangeAt(r));return"["+o+"(Ranges: "+e.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}t.config.checkSelectionRanges=!0;var E,F,S="boolean",N="number",T=t.dom,x=t.util,D=x.isHostMethod,O=t.DomRange,k=t.WrappedRange,A=t.DOMException,I=T.DomPosition,P=t.features,L="Control",M=T.getDocument,$=T.getBody,B=O.rangesEqual,H=D(window,"getSelection"),W=x.isHostObject(document,"selection");P.implementsWinGetSelection=H,P.implementsDocSelection=W;var V=W&&(!H||t.config.preferTextRange);if(V)E=r,t.isSelectionValid=function(t){var e=i(t,"isSelectionValid").document,n=e.selection;return"None"!=n.type||M(n.createRange().parentElement())==e};else{if(!H)return e.fail("Neither document.selection or window.getSelection() detected."),!1;E=o,t.isSelectionValid=function(){return!0}}t.getNativeSelection=E;var U=E();if(!U)return e.fail("Native selection was null (possibly issue 138?)"),!1;var j=t.createNativeRange(document),z=$(document),q=x.areHostProperties(U,["anchorNode","focusNode","anchorOffset","focusOffset"]);P.selectionHasAnchorAndFocus=q;var Q=D(U,"extend");P.selectionHasExtend=Q;var K=typeof U.rangeCount==N;P.selectionHasRangeCount=K;var G=!1,Y=!0,X=Q?function(e,n){var i=O.getRangeDocument(n),o=t.createRange(i);o.collapseToPoint(n.endContainer,n.endOffset),e.addRange(c(o)),e.extend(n.startContainer,n.startOffset)}:null;x.areHostMethods(U,["addRange","getRangeAt","removeAllRanges"])&&typeof U.rangeCount==N&&P.implementsDomRange&&!function(){var e=window.getSelection();if(e){for(var n=e.rangeCount,i=n>1,o=[],r=a(e),s=0;s<n;++s)o[s]=e.getRangeAt(s);var l=T.createTestElement(document,"",!1),u=l.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(u,1),c.collapse(!0),e.removeAllRanges(),e.addRange(c),Y=1==e.rangeCount,e.removeAllRanges(),!i){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)G=!1;else{var h=c.cloneRange();c.setStart(u,0),h.setEnd(u,3),h.setStart(u,2),e.addRange(c),e.addRange(h),G=2==e.rangeCount}}for(T.removeNode(l),e.removeAllRanges(),s=0;s<n;++s)0==s&&r?X?X(e,o[s]):(t.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(o[s])):e.addRange(o[s])}}(),P.selectionSupportsMultipleRanges=G,P.collapsedNonEditableSelectionsSupported=Y;var Z,J=!1;z&&D(z,"createControlRange")&&(Z=z.createControlRange(),x.areHostProperties(Z,["item","add"])&&(J=!0)),P.implementsControlRange=J,F=q?function(t){return t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset}:function(t){return!!t.rangeCount&&t.getRangeAt(t.rangeCount-1).collapsed};var tt;D(U,"getRangeAt")?tt=function(t,e){try{return t.getRangeAt(e)}catch(n){return null}}:q&&(tt=function(e){var n=M(e.anchorNode),i=t.createRange(n);return i.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),i.collapsed!==this.isCollapsed&&i.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),i}),v.prototype=t.selectionPrototype;var et=[],nt=function(t){if(t&&t instanceof v)return t.refresh(),t;t=i(t,"getNativeSelection");var e=b(t),n=E(t),o=W?r(t):null;return e?(e.nativeSelection=n,e.docSelection=o,e.refresh()):(e=new v(n,o,t),et.push({win:t,selection:e})),e};t.getSelection=nt,x.createAliasForDeprecatedMethod(t,"getIframeSelection","getSelection");var it=v.prototype;if(!V&&q&&x.areHostMethods(U,["removeAllRanges","addRange"])){it.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),u(this)};var ot=function(t,e){X(t.nativeSelection,e),t.refresh()};K?it.addRange=function(e,i){if(J&&W&&this.docSelection.type==L)m(this,e);else if(n(i)&&Q)ot(this,e);else{var o;G?o=this.rangeCount:(this.removeAllRanges(),o=0);var r=c(e).cloneRange();try{this.nativeSelection.addRange(r)}catch(a){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==o+1){if(t.config.checkSelectionRanges){var l=tt(this.nativeSelection,this.rangeCount-1);l&&!B(l,e)&&(e=new k(l))}this._ranges[this.rangeCount-1]=e,s(this,e,st(this.nativeSelection)),this.isCollapsed=F(this)}else this.refresh()}}:it.addRange=function(t,e){n(e)&&Q?ot(this,t):(this.nativeSelection.addRange(c(t)),this.refresh())},it.setRanges=function(t){if(J&&W&&t.length>1)y(this,t);else{this.removeAllRanges();for(var e=0,n=t.length;e<n;++e)this.addRange(t[e])}}}else{if(!(D(U,"empty")&&D(j,"select")&&J&&V))return e.fail("No means of selecting a Range or TextRange was found"),!1;it.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var t;if(this.anchorNode)t=M(this.anchorNode);else if(this.docSelection.type==L){var e=this.docSelection.createRange();e.length&&(t=M(e.item(0)))}if(t){var n=$(t).createTextRange();n.select(),this.docSelection.empty()}}}catch(i){}u(this)},it.addRange=function(e){this.docSelection.type==L?m(this,e):(t.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,s(this,e,!1))},it.setRanges=function(t){this.removeAllRanges();var e=t.length;e>1?y(this,t):e&&this.addRange(t[0])}}it.getRangeAt=function(t){if(t<0||t>=this.rangeCount)throw new A("INDEX_SIZE_ERR");return this._ranges[t].cloneRange()};var rt;if(V)rt=function(e){var n;t.isSelectionValid(e.win)?n=e.docSelection.createRange():(n=$(e.win.document).createTextRange(),n.collapse(!0)),e.docSelection.type==L?g(e):f(n)?p(e,n):u(e)};else if(D(U,"getRangeAt")&&typeof U.rangeCount==N)rt=function(e){if(J&&W&&e.docSelection.type==L)g(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var n=0,i=e.rangeCount;n<i;++n)e._ranges[n]=new t.WrappedRange(e.nativeSelection.getRangeAt(n));s(e,e._ranges[e.rangeCount-1],st(e.nativeSelection)),e.isCollapsed=F(e)}else u(e)};else{if(!q||typeof U.isCollapsed!=S||typeof j.collapsed!=S||!P.implementsDomRange)return e.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;rt=function(t){var e,n=t.nativeSelection;n.anchorNode?(e=tt(n,0),t._ranges=[e],t.rangeCount=1,l(t),t.isCollapsed=F(t)):u(t)}}it.refresh=function(t){var e=t?this._ranges.slice(0):null,n=this.anchorNode,i=this.anchorOffset;if(rt(this),t){var o=e.length;if(o!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=i)return!0;for(;o--;)if(!B(e[o],this._ranges[o]))return!0;return!1}};var at=function(t,e){var n=t.getAllRanges();t.removeAllRanges();for(var i=0,o=n.length;i<o;++i)B(e,n[i])||t.addRange(n[i]);t.rangeCount||u(t)};J&&W?it.removeRange=function(t){if(this.docSelection.type==L){for(var e,n=this.docSelection.createRange(),i=h(t),o=M(n.item(0)),r=$(o).createControlRange(),a=!1,s=0,l=n.length;s<l;++s)e=n.item(s),e!==i||a?r.add(n.item(s)):a=!0;r.select(),g(this)}else at(this,t)}:it.removeRange=function(t){at(this,t)};var st;!V&&q&&P.implementsDomRange?(st=a,it.isBackward=function(){return st(this)}):st=it.isBackward=function(){return!1},it.isBackwards=it.isBackward,it.toString=function(){for(var t=[],e=0,n=this.rangeCount;e<n;++e)t[e]=""+this._ranges[e];return t.join("")},it.collapse=function(e,n){C(this,e);var i=t.createRange(e);i.collapseToPoint(e,n),this.setSingleRange(i),this.isCollapsed=!0},it.collapseToStart=function(){if(!this.rangeCount)throw new A("INVALID_STATE_ERR");var t=this._ranges[0];this.collapse(t.startContainer,t.startOffset)},it.collapseToEnd=function(){if(!this.rangeCount)throw new A("INVALID_STATE_ERR");var t=this._ranges[this.rangeCount-1];this.collapse(t.endContainer,t.endOffset)},it.selectAllChildren=function(e){C(this,e);var n=t.createRange(e);n.selectNodeContents(e),this.setSingleRange(n)},it.deleteFromDocument=function(){if(J&&W&&this.docSelection.type==L){for(var t,e=this.docSelection.createRange();e.length;)t=e.item(0),e.remove(t),T.removeNode(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var i=0,o=n.length;i<o;++i)n[i].deleteContents();this.addRange(n[o-1])}}},it.eachRange=function(t,e){for(var n=0,i=this._ranges.length;n<i;++n)if(t(this.getRangeAt(n)))return e},it.getAllRanges=function(){var t=[];return this.eachRange(function(e){t.push(e)}),t},it.setSingleRange=function(t,e){this.removeAllRanges(),this.addRange(t,e)},it.callMethodOnEachRange=function(t,e){var n=[];return this.eachRange(function(i){n.push(i[t].apply(i,e||[]))}),n},it.setStart=w(!0),it.setEnd=w(!1),t.rangePrototype.select=function(t){nt(this.getDocument()).setSingleRange(this,t)},it.changeEachRange=function(t){var e=[],n=this.isBackward();this.eachRange(function(n){t(n),e.push(n)}),this.removeAllRanges(),n&&1==e.length?this.addRange(e[0],"backward"):this.setRanges(e)},it.containsNode=function(t,e){return this.eachRange(function(n){return n.containsNode(t,e)},!0)||!1},it.getBookmark=function(t){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[t])}},it.moveToBookmark=function(e){for(var n,i,o=[],r=0;n=e.rangeBookmarks[r++];)i=t.createRange(this.win),i.moveToBookmark(n),o.push(i);e.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},it.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},it.restoreRanges=function(t){this.removeAllRanges();for(var e,n=0;e=t.ranges[n];++n)this.addRange(e,t.backward&&0==n)},it.toHtml=function(){var t=[];return this.eachRange(function(e){t.push(O.toHtml(e))}),t.join("")},P.implementsTextRange&&(it.getNativeTextRange=function(){var n;if(n=this.docSelection){var i=n.createRange();if(f(i))return i;throw e.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return t.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw e.createError("getNativeTextRange: selection contains no range")}),it.getName=function(){return"WrappedSelection"},it.inspect=function(){return R(this)},it.detach=function(){b(this.win,"delete"),_(this)},v.detachAll=function(){b(null,"deleteAll")},v.inspect=R,v.isDirectionBackward=n,t.Selection=v,t.selectionPrototype=it,t.addShimListener(function(t){"undefined"==typeof t.getSelection&&(t.getSelection=function(){return nt(t)}),t=null})});var $=!1,B=function(t){$||($=!0,!A.initialized&&A.config.autoInitialize&&d())};return O&&("complete"==document.readyState?B():(t(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",B,!1),P(window,"load",B))),A},this)}});